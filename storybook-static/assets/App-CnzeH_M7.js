import{j as S}from"./DriftIndicator-1SzGZTX-.js";import{r as W}from"./index-C3JiJ1qr.js";import{_ as de}from"./iframe-TXMZdKjn.js";import{F as Gr}from"./FabricList-uA2FlVB8.js";import{D as zr}from"./DriftSection-CESTiHQZ.js";var Yr=W.useLayoutEffect;function Wr(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function Hr(){const e=Wr();if(e.__xstate__)return e.__xstate__}const qr=e=>{if(typeof window>"u")return;const t=Hr();t&&t.register(e)};class qt{constructor(t){this._process=t,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(t){const n={value:t,next:null};if(this._current){this._last.next=n,this._last=n;return}this._current=n,this._last=n,this._active&&this.flush()}flush(){for(;this._current;){const t=this._current;this._process(t.value),this._current=t.next}this._last=null}}const Gn=".",Kr="",zn="",Jr="#",Xr="*",Yn="xstate.init",ze="xstate.stop";function Qr(e,t){return{type:`xstate.after.${e}.${t}`}}function xt(e,t){return{type:`xstate.done.state.${e}`,output:t}}function ei(e,t){return{type:`xstate.done.actor.${e}`,output:t,actorId:e}}function ti(e,t){return{type:`xstate.error.actor.${e}`,error:t,actorId:e}}function Wn(e){return{type:Yn,input:e}}function G(e){setTimeout(()=>{throw e})}const ni=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Hn(e,t){const n=Kt(e),r=Kt(t);return typeof r=="string"?typeof n=="string"?r===n:!1:typeof n=="string"?n in r:Object.keys(n).every(i=>i in r?Hn(n[i],r[i]):!1)}function jt(e){if(Kn(e))return e;const t=[];let n="";for(let r=0;r<e.length;r++){switch(e.charCodeAt(r)){case 92:n+=e[r+1],r++;continue;case 46:t.push(n),n="";continue}n+=e[r]}return t.push(n),t}function Kt(e){if(Li(e))return e.value;if(typeof e!="string")return e;const t=jt(e);return ri(t)}function ri(e){if(e.length===1)return e[0];const t={};let n=t;for(let r=0;r<e.length-1;r++)if(r===e.length-2)n[e[r]]=e[r+1];else{const i=n;n={},i[e[r]]=n}return t}function Jt(e,t){const n={},r=Object.keys(e);for(let i=0;i<r.length;i++){const s=r[i];n[s]=t(e[s],s,e,i)}return n}function qn(e){return Kn(e)?e:[e]}function J(e){return e===void 0?[]:qn(e)}function wt(e,t,n,r){return typeof e=="function"?e({context:t,event:n,self:r}):e}function Kn(e){return Array.isArray(e)}function ii(e){return e.type.startsWith("xstate.error.actor")}function pe(e){return qn(e).map(t=>typeof t>"u"||typeof t=="string"?{target:t}:t)}function Jn(e){if(!(e===void 0||e===Kr))return J(e)}function bt(e,t,n){const r=typeof e=="object",i=r?e:void 0;return{next:(r?e.next:e)?.bind(i),error:(r?e.error:t)?.bind(i),complete:(r?e.complete:n)?.bind(i)}}function Xt(e,t){return`${t}.${e}`}function Lt(e,t){const n=t.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!n)return e.implementations.actors[t];const[,r,i]=n,o=e.getStateNodeById(i).config.invoke;return(Array.isArray(o)?o[r]:o).src}function Qt(e,t){return`${e.sessionId}.${t}`}let si=0;function oi(e,t){const n=new Map,r=new Map,i=new WeakMap,s=new Set,o={},{clock:a,logger:c}=t,l={schedule:(f,h,p,y,k=Math.random().toString(36).slice(2))=>{const N={source:f,target:h,event:p,delay:y,id:k,startedAt:Date.now()},T=Qt(f,k);u._snapshot._scheduledEvents[T]=N;const Vr=a.setTimeout(()=>{delete o[T],delete u._snapshot._scheduledEvents[T],u._relay(f,h,p)},y);o[T]=Vr},cancel:(f,h)=>{const p=Qt(f,h),y=o[p];delete o[p],delete u._snapshot._scheduledEvents[p],y!==void 0&&a.clearTimeout(y)},cancelAll:f=>{for(const h in u._snapshot._scheduledEvents){const p=u._snapshot._scheduledEvents[h];p.source===f&&l.cancel(f,p.id)}}},d=f=>{if(!s.size)return;const h={...f,rootId:e.sessionId};s.forEach(p=>p.next?.(h))},u={_snapshot:{_scheduledEvents:(t?.snapshot&&t.snapshot.scheduler)??{}},_bookId:()=>`x:${si++}`,_register:(f,h)=>(n.set(f,h),f),_unregister:f=>{n.delete(f.sessionId);const h=i.get(f);h!==void 0&&(r.delete(h),i.delete(f))},get:f=>r.get(f),_set:(f,h)=>{const p=r.get(f);if(p&&p!==h)throw new Error(`Actor with system ID '${f}' already exists.`);r.set(f,h),i.set(h,f)},inspect:f=>{const h=bt(f);return s.add(h),{unsubscribe(){s.delete(h)}}},_sendInspectionEvent:d,_relay:(f,h,p)=>{u._sendInspectionEvent({type:"@xstate.event",sourceRef:f,actorRef:h,event:p}),h._send(p)},scheduler:l,getSnapshot:()=>({_scheduledEvents:{...u._snapshot._scheduledEvents}}),start:()=>{const f=u._snapshot._scheduledEvents;u._snapshot._scheduledEvents={};for(const h in f){const{source:p,target:y,event:k,delay:N,id:T}=f[h];l.schedule(p,y,k,N,T)}},_clock:a,_logger:c};return u}let lt=!1;const Mt=1;let $=function(e){return e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped",e}({});const ai={clock:{setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)},logger:console.log.bind(console),devTools:!1};class ci{constructor(t,n){this.logic=t,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new qt(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=$.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const r={...ai,...n},{clock:i,logger:s,parent:o,syncSnapshot:a,id:c,systemId:l,inspect:d}=r;this.system=o?o.system:oi(this,{clock:i,logger:s}),d&&!o&&this.system.inspect(bt(d)),this.sessionId=this.system._bookId(),this.id=c??this.sessionId,this.logger=n?.logger??this.system._logger,this.clock=n?.clock??this.system._clock,this._parent=o,this._syncSnapshot=a,this.options=r,this.src=r.src??t,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:u=>{this._deferred.push(u)},system:this.system,stopChild:u=>{if(u._parent!==this)throw new Error(`Cannot stop child actor ${u.id} of ${this.id} because it is not a child`);u._stop()},emit:u=>{const f=this.eventListeners.get(u.type),h=this.eventListeners.get("*");if(!f&&!h)return;const p=[...f?f.values():[],...h?h.values():[]];for(const y of p)try{y(u)}catch(k){G(k)}},actionExecutor:u=>{const f=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:u.type,params:u.params}}),!u.exec)return;const h=lt;try{lt=!0,u.exec(u.info,u.params)}finally{lt=h}};this._processingStatus===$.Running?f():this._deferred.push(f)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),l&&(this._systemId=l,this.system._set(l,this)),this._initState(n?.snapshot??n?.state),l&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(t){try{this._snapshot=t?this.logic.restoreSnapshot?this.logic.restoreSnapshot(t,this._actorScope):t:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(n){this._snapshot={status:"error",output:void 0,error:n}}}update(t,n){this._snapshot=t;let r;for(;r=this._deferred.shift();)try{r()}catch(i){this._deferred.length=0,this._snapshot={...t,status:"error",error:i}}switch(this._snapshot.status){case"active":for(const i of this.observers)try{i.next?.(t)}catch(s){G(s)}break;case"done":for(const i of this.observers)try{i.next?.(t)}catch(s){G(s)}this._stopProcedure(),this._complete(),this._doneEvent=ei(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:n,snapshot:t})}subscribe(t,n,r){const i=bt(t,n,r);if(this._processingStatus!==$.Stopped)this.observers.add(i);else switch(this._snapshot.status){case"done":try{i.complete?.()}catch(s){G(s)}break;case"error":{const s=this._snapshot.error;if(!i.error)G(s);else try{i.error(s)}catch(o){G(o)}break}}return{unsubscribe:()=>{this.observers.delete(i)}}}on(t,n){let r=this.eventListeners.get(t);r||(r=new Set,this.eventListeners.set(t,r));const i=n.bind(void 0);return r.add(i),{unsubscribe:()=>{r.delete(i)}}}start(){if(this._processingStatus===$.Running)return this;this._syncSnapshot&&this.subscribe({next:r=>{r.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:r})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=$.Running;const t=Wn(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:t}),this._snapshot.status){case"done":return this.update(this._snapshot,t),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(r){return this._snapshot={...this._snapshot,status:"error",error:r},this._error(r),this}return this.update(this._snapshot,t),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(t){let n,r;try{n=this.logic.transition(this._snapshot,t,this._actorScope)}catch(i){r={err:i}}if(r){const{err:i}=r;this._snapshot={...this._snapshot,status:"error",error:i},this._error(i);return}this.update(n,t),t.type===ze&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===$.Stopped?this:(this.mailbox.clear(),this._processingStatus===$.NotStarted?(this._processingStatus=$.Stopped,this):(this.mailbox.enqueue({type:ze}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(const t of this.observers)try{t.complete?.()}catch(n){G(n)}this.observers.clear()}_reportError(t){if(!this.observers.size){this._parent||G(t);return}let n=!1;for(const r of this.observers){const i=r.error;n||=!i;try{i?.(t)}catch(s){G(s)}}this.observers.clear(),n&&G(t)}_error(t){this._stopProcedure(),this._reportError(t),this._parent&&this.system._relay(this,this._parent,ti(this.id,t))}_stopProcedure(){return this._processingStatus!==$.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new qt(this._process.bind(this)),this._processingStatus=$.Stopped,this.system._unregister(this),this)}_send(t){this._processingStatus!==$.Stopped&&this.mailbox.enqueue(t)}send(t){this.system._relay(void 0,this,t)}attachDevTools(){const{devTools:t}=this.options;t&&(typeof t=="function"?t:qr)(this)}toJSON(){return{xstate$$type:Mt,id:this.id}}getPersistedSnapshot(t){return this.logic.getPersistedSnapshot(this._snapshot,t)}[ni](){return this}getSnapshot(){return this._snapshot}}function xe(e,...[t]){return new ci(e,t)}function li(e,t,n,r,{sendId:i}){const s=typeof i=="function"?i(n,r):i;return[t,{sendId:s},void 0]}function ui(e,t){e.defer(()=>{e.system.scheduler.cancel(e.self,t.sendId)})}function di(e){function t(n,r){}return t.type="xstate.cancel",t.sendId=e,t.resolve=li,t.execute=ui,t}function fi(e,t,n,r,{id:i,systemId:s,src:o,input:a,syncSnapshot:c}){const l=typeof o=="string"?Lt(t.machine,o):o,d=typeof i=="function"?i(n):i;let u,f;return l&&(f=typeof a=="function"?a({context:t.context,event:n.event,self:e.self}):a,u=xe(l,{id:d,src:o,parent:e.self,syncSnapshot:c,systemId:s,input:f})),[le(t,{children:{...t.children,[d]:u}}),{id:i,systemId:s,actorRef:u,src:o,input:f},void 0]}function hi(e,{actorRef:t}){t&&e.defer(()=>{t._processingStatus!==$.Stopped&&t.start()})}function pi(...[e,{id:t,systemId:n,input:r,syncSnapshot:i=!1}={}]){function s(o,a){}return s.type="xstate.spawnChild",s.id=t,s.systemId=n,s.src=e,s.input=r,s.syncSnapshot=i,s.resolve=fi,s.execute=hi,s}function mi(e,t,n,r,{actorRef:i}){const s=typeof i=="function"?i(n,r):i,o=typeof s=="string"?t.children[s]:s;let a=t.children;return o&&(a={...a},delete a[o.id]),[le(t,{children:a}),o,void 0]}function gi(e,t){if(t){if(e.system._unregister(t),t._processingStatus!==$.Running){e.stopChild(t);return}e.defer(()=>{e.stopChild(t)})}}function Xn(e){function t(n,r){}return t.type="xstate.stopChild",t.actorRef=e,t.resolve=mi,t.execute=gi,t}function $t(e,t,n,r){const{machine:i}=r,s=typeof e=="function",o=s?e:i.implementations.guards[typeof e=="string"?e:e.type];if(!s&&!o)throw new Error(`Guard '${typeof e=="string"?e:e.type}' is not implemented.'.`);if(typeof o!="function")return $t(o,t,n,r);const a={context:t,event:n},c=s||typeof e=="string"?void 0:"params"in e?typeof e.params=="function"?e.params({context:t,event:n}):e.params:void 0;return"check"in o?o.check(r,a,o):o(a,c)}const Pt=e=>e.type==="atomic"||e.type==="final";function we(e){return Object.values(e.states).filter(t=>t.type!=="history")}function Ze(e,t){const n=[];if(t===e)return n;let r=e.parent;for(;r&&r!==t;)n.push(r),r=r.parent;return n}function Ye(e){const t=new Set(e),n=er(t);for(const r of t)if(r.type==="compound"&&(!n.get(r)||!n.get(r).length))en(r).forEach(i=>t.add(i));else if(r.type==="parallel"){for(const i of we(r))if(i.type!=="history"&&!t.has(i)){const s=en(i);for(const o of s)t.add(o)}}for(const r of t){let i=r.parent;for(;i;)t.add(i),i=i.parent}return t}function Qn(e,t){const n=t.get(e);if(!n)return{};if(e.type==="compound"){const i=n[0];if(i){if(Pt(i))return i.key}else return{}}const r={};for(const i of n)r[i.key]=Qn(i,t);return r}function er(e){const t=new Map;for(const n of e)t.has(n)||t.set(n,[]),n.parent&&(t.has(n.parent)||t.set(n.parent,[]),t.get(n.parent).push(n));return t}function tr(e,t){const n=Ye(t);return Qn(e,er(n))}function Bt(e,t){return t.type==="compound"?we(t).some(n=>n.type==="final"&&e.has(n)):t.type==="parallel"?we(t).every(n=>Bt(e,n)):t.type==="final"}const st=e=>e[0]===Jr;function yi(e,t){return e.transitions.get(t)||[...e.transitions.keys()].filter(r=>{if(r===Xr)return!0;if(!r.endsWith(".*"))return!1;const i=r.split("."),s=t.split(".");for(let o=0;o<i.length;o++){const a=i[o],c=s[o];if(a==="*")return o===i.length-1;if(a!==c)return!1}return!0}).sort((r,i)=>i.length-r.length).flatMap(r=>e.transitions.get(r))}function vi(e){const t=e.config.after;if(!t)return[];const n=i=>{const s=Qr(i,e.id),o=s.type;return e.entry.push(Yi(s,{id:o,delay:i})),e.exit.push(di(o)),o};return Object.keys(t).flatMap(i=>{const s=t[i],o=typeof s=="string"?{target:s}:s,a=Number.isNaN(+i)?i:+i,c=n(a);return J(o).map(l=>({...l,event:c,delay:a}))}).map(i=>{const{delay:s}=i;return{...se(e,i.event,i),delay:s}})}function se(e,t,n){const r=Jn(n.target),i=n.reenter??!1,s=wi(e,r),o={...n,actions:J(n.actions),guard:n.guard,target:s,source:e,reenter:i,eventType:t,toJSON:()=>({...o,source:`#${e.id}`,target:s?s.map(a=>`#${a.id}`):void 0})};return o}function _i(e){const t=new Map;if(e.config.on)for(const n of Object.keys(e.config.on)){if(n===zn)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const r=e.config.on[n];t.set(n,pe(r).map(i=>se(e,n,i)))}if(e.config.onDone){const n=`xstate.done.state.${e.id}`;t.set(n,pe(e.config.onDone).map(r=>se(e,n,r)))}for(const n of e.invoke){if(n.onDone){const r=`xstate.done.actor.${n.id}`;t.set(r,pe(n.onDone).map(i=>se(e,r,i)))}if(n.onError){const r=`xstate.error.actor.${n.id}`;t.set(r,pe(n.onError).map(i=>se(e,r,i)))}if(n.onSnapshot){const r=`xstate.snapshot.${n.id}`;t.set(r,pe(n.onSnapshot).map(i=>se(e,r,i)))}}for(const n of e.after){let r=t.get(n.eventType);r||(r=[],t.set(n.eventType,r)),r.push(n)}return t}function xi(e,t){const n=typeof t=="string"?e.states[t]:t?e.states[t.target]:void 0;if(!n&&t)throw new Error(`Initial state node "${t}" not found on parent state node #${e.id}`);const r={source:e,actions:!t||typeof t=="string"?[]:J(t.actions),eventType:null,reenter:!1,target:n?[n]:[],toJSON:()=>({...r,source:`#${e.id}`,target:n?[`#${n.id}`]:[]})};return r}function wi(e,t){if(t!==void 0)return t.map(n=>{if(typeof n!="string")return n;if(st(n))return e.machine.getStateNodeById(n);const r=n[0]===Gn;if(r&&!e.parent)return We(e,n.slice(1));const i=r?e.key+n:n;if(e.parent)try{return We(e.parent,i)}catch(s){throw new Error(`Invalid transition definition for state node '${e.id}':
${s.message}`)}else throw new Error(`Invalid target: "${n}" is not a valid target from the root node. Did you mean ".${n}"?`)})}function nr(e){const t=Jn(e.config.target);return t?{target:t.map(n=>typeof n=="string"?We(e.parent,n):n)}:e.parent.initial}function oe(e){return e.type==="history"}function en(e){const t=rr(e);for(const n of t)for(const r of Ze(n,e))t.add(r);return t}function rr(e){const t=new Set;function n(r){if(!t.has(r)){if(t.add(r),r.type==="compound")n(r.initial.target[0]);else if(r.type==="parallel")for(const i of we(r))n(i)}}return n(e),t}function be(e,t){if(st(t))return e.machine.getStateNodeById(t);if(!e.states)throw new Error(`Unable to retrieve child state '${t}' from '${e.id}'; no child states exist.`);const n=e.states[t];if(!n)throw new Error(`Child state '${t}' does not exist on '${e.id}'`);return n}function We(e,t){if(typeof t=="string"&&st(t))try{return e.machine.getStateNodeById(t)}catch{}const n=jt(t).slice();let r=e;for(;n.length;){const i=n.shift();if(!i.length)break;r=be(r,i)}return r}function He(e,t){if(typeof t=="string"){const i=e.states[t];if(!i)throw new Error(`State '${t}' does not exist on '${e.id}'`);return[e,i]}const n=Object.keys(t),r=n.map(i=>be(e,i)).filter(Boolean);return[e.machine.root,e].concat(r,n.reduce((i,s)=>{const o=be(e,s);if(!o)return i;const a=He(o,t[s]);return i.concat(a)},[]))}function bi(e,t,n,r){const s=be(e,t).next(n,r);return!s||!s.length?e.next(n,r):s}function ki(e,t,n,r){const i=Object.keys(t),s=be(e,i[0]),o=Zt(s,t[i[0]],n,r);return!o||!o.length?e.next(n,r):o}function Si(e,t,n,r){const i=[];for(const s of Object.keys(t)){const o=t[s];if(!o)continue;const a=be(e,s),c=Zt(a,o,n,r);c&&i.push(...c)}return i.length?i:e.next(n,r)}function Zt(e,t,n,r){return typeof t=="string"?bi(e,t,n,r):Object.keys(t).length===1?ki(e,t,n,r):Si(e,t,n,r)}function Ai(e){return Object.keys(e.states).map(t=>e.states[t]).filter(t=>t.type==="history")}function te(e,t){let n=e;for(;n.parent&&n.parent!==t;)n=n.parent;return n.parent===t}function Ti(e,t){const n=new Set(e),r=new Set(t);for(const i of n)if(r.has(i))return!0;for(const i of r)if(n.has(i))return!0;return!1}function ir(e,t,n){const r=new Set;for(const i of e){let s=!1;const o=new Set;for(const a of r)if(Ti(kt([i],t,n),kt([a],t,n)))if(te(i.source,a.source))o.add(a);else{s=!0;break}if(!s){for(const a of o)r.delete(a);r.add(i)}}return Array.from(r)}function Ci(e){const[t,...n]=e;for(const r of Ze(t,void 0))if(n.every(i=>te(i,r)))return r}function Ut(e,t){if(!e.target)return[];const n=new Set;for(const r of e.target)if(oe(r))if(t[r.id])for(const i of t[r.id])n.add(i);else for(const i of Ut(nr(r),t))n.add(i);else n.add(r);return[...n]}function sr(e,t){const n=Ut(e,t);if(!n)return;if(!e.reenter&&n.every(i=>i===e.source||te(i,e.source)))return e.source;const r=Ci(n.concat(e.source));if(r)return r;if(!e.reenter)return e.source.machine.root}function kt(e,t,n){const r=new Set;for(const i of e)if(i.target?.length){const s=sr(i,n);i.reenter&&i.source===s&&r.add(s);for(const o of t)te(o,s)&&r.add(o)}return[...r]}function Ei(e,t){if(e.length!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function St(e,t,n,r,i,s){if(!e.length)return t;const o=new Set(t._nodes);let a=t.historyValue;const c=ir(e,o,a);let l=t;i||([l,a]=Ri(l,r,n,c,o,a,s,n.actionExecutor)),l=ke(l,r,n,c.flatMap(u=>u.actions),s,void 0),l=Oi(l,r,n,c,o,s,a,i);const d=[...o];l.status==="done"&&(l=ke(l,r,n,d.sort((u,f)=>f.order-u.order).flatMap(u=>u.exit),s,void 0));try{return a===t.historyValue&&Ei(t._nodes,o)?l:le(l,{_nodes:d,historyValue:a})}catch(u){throw u}}function Ii(e,t,n,r,i){if(r.output===void 0)return;const s=xt(i.id,i.output!==void 0&&i.parent?wt(i.output,e.context,t,n.self):void 0);return wt(r.output,e.context,s,n.self)}function Oi(e,t,n,r,i,s,o,a){let c=e;const l=new Set,d=new Set;Di(r,o,d,l),a&&d.add(e.machine.root);const u=new Set;for(const f of[...l].sort((h,p)=>h.order-p.order)){i.add(f);const h=[];h.push(...f.entry);for(const p of f.invoke)h.push(pi(p.src,{...p,syncSnapshot:!!p.onSnapshot}));if(d.has(f)){const p=f.initial.actions;h.push(...p)}if(c=ke(c,t,n,h,s,f.invoke.map(p=>p.id)),f.type==="final"){const p=f.parent;let y=p?.type==="parallel"?p:p?.parent,k=y||f;for(p?.type==="compound"&&s.push(xt(p.id,f.output!==void 0?wt(f.output,c.context,t,n.self):void 0));y?.type==="parallel"&&!u.has(y)&&Bt(i,y);)u.add(y),s.push(xt(y.id)),k=y,y=y.parent;if(y)continue;c=le(c,{status:"done",output:Ii(c,t,n,c.machine.root,k)})}}return c}function Di(e,t,n,r){for(const i of e){const s=sr(i,t);for(const a of i.target||[])!oe(a)&&(i.source!==a||i.source!==s||i.reenter)&&(r.add(a),n.add(a)),ye(a,t,n,r);const o=Ut(i,t);for(const a of o){const c=Ze(a,s);s?.type==="parallel"&&c.push(s),or(r,t,n,c,!i.source.parent&&i.reenter?void 0:s)}}}function ye(e,t,n,r){if(oe(e))if(t[e.id]){const i=t[e.id];for(const s of i)r.add(s),ye(s,t,n,r);for(const s of i)ut(s,e.parent,r,t,n)}else{const i=nr(e);for(const s of i.target)r.add(s),i===e.parent?.initial&&n.add(e.parent),ye(s,t,n,r);for(const s of i.target)ut(s,e.parent,r,t,n)}else if(e.type==="compound"){const[i]=e.initial.target;oe(i)||(r.add(i),n.add(i)),ye(i,t,n,r),ut(i,e,r,t,n)}else if(e.type==="parallel")for(const i of we(e).filter(s=>!oe(s)))[...r].some(s=>te(s,i))||(oe(i)||(r.add(i),n.add(i)),ye(i,t,n,r))}function or(e,t,n,r,i){for(const s of r)if((!i||te(s,i))&&e.add(s),s.type==="parallel")for(const o of we(s).filter(a=>!oe(a)))[...e].some(a=>te(a,o))||(e.add(o),ye(o,t,n,e))}function ut(e,t,n,r,i){or(n,r,i,Ze(e,t))}function Ri(e,t,n,r,i,s,o,a){let c=e;const l=kt(r,i,s);l.sort((u,f)=>f.order-u.order);let d;for(const u of l)for(const f of Ai(u)){let h;f.history==="deep"?h=p=>Pt(p)&&te(p,u):h=p=>p.parent===u,d??={...s},d[f.id]=Array.from(i).filter(h)}for(const u of l)c=ke(c,t,n,[...u.exit,...u.invoke.map(f=>Xn(f.id))],o,void 0),i.delete(u);return[c,d||s]}function Fi(e,t){return e.implementations.actions[t]}function ar(e,t,n,r,i,s){const{machine:o}=e;let a=e;for(const c of r){const l=typeof c=="function",d=l?c:Fi(o,typeof c=="string"?c:c.type),u={context:a.context,event:t,self:n.self,system:n.system},f=l||typeof c=="string"?void 0:"params"in c?typeof c.params=="function"?c.params({context:a.context,event:t}):c.params:void 0;if(!d||!("resolve"in d)){n.actionExecutor({type:typeof c=="string"?c:typeof c=="object"?c.type:c.name||"(anonymous)",info:u,params:f,exec:d});continue}const h=d,[p,y,k]=h.resolve(n,a,u,f,d,i);a=p,"retryResolve"in h&&s?.push([h,y]),"execute"in h&&n.actionExecutor({type:h.type,info:u,params:y,exec:h.execute.bind(null,n,y)}),k&&(a=ar(a,t,n,k,i,s))}return a}function ke(e,t,n,r,i,s){const o=s?[]:void 0,a=ar(e,t,n,r,{internalQueue:i,deferredActorIds:s},o);return o?.forEach(([c,l])=>{c.retryResolve(n,a,l)}),a}function dt(e,t,n,r){let i=e;const s=[];function o(l,d,u){n.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:n.self,event:d,snapshot:l,_transitions:u}),s.push(l)}if(t.type===ze)return i=le(tn(i,t,n),{status:"stopped"}),o(i,t,[]),{snapshot:i,microstates:s};let a=t;if(a.type!==Yn){const l=a,d=ii(l),u=nn(l,i);if(d&&!u.length)return i=le(e,{status:"error",error:l.error}),o(i,l,[]),{snapshot:i,microstates:s};i=St(u,e,n,a,!1,r),o(i,l,u)}let c=!0;for(;i.status==="active";){let l=c?Ni(i,a):[];const d=l.length?i:void 0;if(!l.length){if(!r.length)break;a=r.shift(),l=nn(a,i)}i=St(l,i,n,a,!1,r),c=i!==d,o(i,a,l)}return i.status!=="active"&&tn(i,a,n),{snapshot:i,microstates:s}}function tn(e,t,n){return ke(e,t,n,Object.values(e.children).map(r=>Xn(r)),[],void 0)}function nn(e,t){return t.machine.getTransitionData(t,e)}function Ni(e,t){const n=new Set,r=e._nodes.filter(Pt);for(const i of r)e:for(const s of[i].concat(Ze(i,void 0)))if(s.always){for(const o of s.always)if(o.guard===void 0||$t(o.guard,e.context,t,e)){n.add(o);break e}}return ir(Array.from(n),new Set(e._nodes),e.historyValue)}function ji(e,t){const n=Ye(He(e,t));return tr(e,[...n])}function Li(e){return!!e&&typeof e=="object"&&"machine"in e&&"value"in e}const Mi=function(t){return Hn(t,this.value)},$i=function(t){return this.tags.has(t)},Pi=function(t){const n=this.machine.getTransitionData(this,t);return!!n?.length&&n.some(r=>r.target!==void 0||r.actions.length)},Bi=function(){const{_nodes:t,tags:n,machine:r,getMeta:i,toJSON:s,can:o,hasTag:a,matches:c,...l}=this;return{...l,tags:Array.from(n)}},Zi=function(){return this._nodes.reduce((t,n)=>(n.meta!==void 0&&(t[n.id]=n.meta),t),{})};function Ge(e,t){return{status:e.status,output:e.output,error:e.error,machine:t,context:e.context,_nodes:e._nodes,value:tr(t.root,e._nodes),tags:new Set(e._nodes.flatMap(n=>n.tags)),children:e.children,historyValue:e.historyValue||{},matches:Mi,hasTag:$i,can:Pi,getMeta:Zi,toJSON:Bi}}function le(e,t={}){return Ge({...e,...t},e.machine)}function Ui(e){if(typeof e!="object"||e===null)return{};const t={};for(const n in e){const r=e[n];Array.isArray(r)&&(t[n]=r.map(i=>({id:i.id})))}return t}function Vi(e,t){const{_nodes:n,tags:r,machine:i,children:s,context:o,can:a,hasTag:c,matches:l,getMeta:d,toJSON:u,...f}=e,h={};for(const y in s){const k=s[y];h[y]={snapshot:k.getPersistedSnapshot(t),src:k.src,systemId:k._systemId,syncSnapshot:k._syncSnapshot}}return{...f,context:cr(o),children:h,historyValue:Ui(f.historyValue)}}function cr(e){let t;for(const n in e){const r=e[n];if(r&&typeof r=="object")if("sessionId"in r&&"send"in r&&"ref"in r)t??=Array.isArray(e)?e.slice():{...e},t[n]={xstate$$type:Mt,id:r.id};else{const i=cr(r);i!==r&&(t??=Array.isArray(e)?e.slice():{...e},t[n]=i)}}return t??e}function Gi(e,t,n,r,{event:i,id:s,delay:o},{internalQueue:a}){const c=t.machine.implementations.delays;if(typeof i=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${i}" }) instead`);const l=typeof i=="function"?i(n,r):i;let d;if(typeof o=="string"){const u=c&&c[o];d=typeof u=="function"?u(n,r):u}else d=typeof o=="function"?o(n,r):o;return typeof d!="number"&&a.push(l),[t,{event:l,id:s,delay:d},void 0]}function zi(e,t){const{event:n,delay:r,id:i}=t;if(typeof r=="number"){e.defer(()=>{const s=e.self;e.system.scheduler.schedule(s,s,n,r,i)});return}}function Yi(e,t){function n(r,i){}return n.type="xstate.raise",n.event=e,n.id=t?.id,n.delay=t?.delay,n.resolve=Gi,n.execute=zi,n}const rn="xstate.promise.resolve",sn="xstate.promise.reject",Ue=new WeakMap;function on(e){return{config:e,transition:(n,r,i)=>{if(n.status!=="active")return n;switch(r.type){case rn:{const s=r.data;return{...n,status:"done",output:s,input:void 0}}case sn:return{...n,status:"error",error:r.data,input:void 0};case ze:return Ue.get(i.self)?.abort(),{...n,status:"stopped",input:void 0};default:return n}},start:(n,{self:r,system:i,emit:s})=>{if(n.status!=="active")return;const o=new AbortController;Ue.set(r,o),Promise.resolve(e({input:n.input,system:i,self:r,signal:o.signal,emit:s})).then(c=>{r.getSnapshot().status==="active"&&(Ue.delete(r),i._relay(r,r,{type:rn,data:c}))},c=>{r.getSnapshot().status==="active"&&(Ue.delete(r),i._relay(r,r,{type:sn,data:c}))})},getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,input:r}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}function Wi(e,{machine:t,context:n},r,i){const s=(o,a)=>{if(typeof o=="string"){const c=Lt(t,o);if(!c)throw new Error(`Actor logic '${o}' not implemented in machine '${t.id}'`);const l=xe(c,{id:a?.id,parent:e.self,syncSnapshot:a?.syncSnapshot,input:typeof a?.input=="function"?a.input({context:n,event:r,self:e.self}):a?.input,src:o,systemId:a?.systemId});return i[l.id]=l,l}else return xe(o,{id:a?.id,parent:e.self,syncSnapshot:a?.syncSnapshot,input:a?.input,src:o,systemId:a?.systemId})};return(o,a)=>{const c=s(o,a);return i[c.id]=c,e.defer(()=>{c._processingStatus!==$.Stopped&&c.start()}),c}}function Hi(e,t,n,r,{assignment:i}){if(!t.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const s={},o={context:t.context,event:n.event,spawn:Wi(e,t,n.event,s),self:e.self,system:e.system};let a={};if(typeof i=="function")a=i(o,r);else for(const l of Object.keys(i)){const d=i[l];a[l]=typeof d=="function"?d(o,r):d}const c=Object.assign({},t.context,a);return[le(t,{context:c,children:Object.keys(s).length?{...t.children,...s}:t.children}),void 0,void 0]}function C(e){function t(n,r){}return t.type="xstate.assign",t.assignment=e,t.resolve=Hi,t}const an=new WeakMap;function fe(e,t,n){let r=an.get(e);return r?t in r||(r[t]=n()):(r={[t]:n()},an.set(e,r)),r[t]}const qi={},De=e=>typeof e=="string"?{type:e}:typeof e=="function"?"resolve"in e?{type:e.type}:{type:e.name}:e;class qe{constructor(t,n){if(this.config=t,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=n._parent,this.key=n._key,this.machine=n._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(Gn),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?Jt(this.config.states,(r,i)=>new qe(r,{_parent:this,_key:i,_machine:this.machine})):qi,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=J(this.config.entry).slice(),this.exit=J(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=J(t.tags).slice()}_initialize(){this.transitions=_i(this),this.config.always&&(this.always=pe(this.config.always).map(t=>se(this,zn,t))),Object.keys(this.states).forEach(t=>{this.states[t]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(De),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(t=>`#${t.id}`),source:`#${this.id}`,actions:this.initial.actions.map(De),eventType:null})}:void 0,history:this.history,states:Jt(this.states,t=>t.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(t=>({...t,actions:t.actions.map(De)})),entry:this.entry.map(De),exit:this.exit.map(De),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return fe(this,"invoke",()=>J(this.config.invoke).map((t,n)=>{const{src:r,systemId:i}=t,s=t.id??Xt(this.id,n),o=typeof r=="string"?r:`xstate.invoke.${Xt(this.id,n)}`;return{...t,src:o,id:s,systemId:i,toJSON(){const{onDone:a,onError:c,...l}=t;return{...l,type:"xstate.invoke",src:o,id:s}}}}))}get on(){return fe(this,"on",()=>[...this.transitions].flatMap(([n,r])=>r.map(i=>[n,i])).reduce((n,[r,i])=>(n[r]=n[r]||[],n[r].push(i),n),{}))}get after(){return fe(this,"delayedTransitions",()=>vi(this))}get initial(){return fe(this,"initial",()=>xi(this,this.config.initial))}next(t,n){const r=n.type,i=[];let s;const o=fe(this,`candidates-${r}`,()=>yi(this,r));for(const a of o){const{guard:c}=a,l=t.context;let d=!1;try{d=!c||$t(c,l,n,t)}catch(u){const f=typeof c=="string"?c:typeof c=="object"?c.type:void 0;throw new Error(`Unable to evaluate guard ${f?`'${f}' `:""}in transition for event '${r}' in state node '${this.id}':
${u.message}`)}if(d){i.push(...a.actions),s=a;break}}return s?[s]:void 0}get events(){return fe(this,"events",()=>{const{states:t}=this,n=new Set(this.ownEvents);if(t)for(const r of Object.keys(t)){const i=t[r];if(i.states)for(const s of i.events)n.add(`${s}`)}return Array.from(n)})}get ownEvents(){const t=new Set([...this.transitions.keys()].filter(n=>this.transitions.get(n).some(r=>!(!r.target&&!r.actions.length&&!r.reenter))));return Array.from(t)}}const Ki="#";class Vt{constructor(t,n){this.config=t,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=t.id||"(machine)",this.implementations={actors:n?.actors??{},actions:n?.actions??{},delays:n?.delays??{},guards:n?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new qe(t,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(t){const{actions:n,guards:r,actors:i,delays:s}=this.implementations;return new Vt(this.config,{actions:{...n,...t.actions},guards:{...r,...t.guards},actors:{...i,...t.actors},delays:{...s,...t.delays}})}resolveState(t){const n=ji(this.root,t.value),r=Ye(He(this.root,n));return Ge({_nodes:[...r],context:t.context||{},children:{},status:Bt(r,this.root)?"done":t.status||"active",output:t.output,error:t.error,historyValue:t.historyValue},this)}transition(t,n,r){return dt(t,n,r,[]).snapshot}microstep(t,n,r){return dt(t,n,r,[]).microstates}getTransitionData(t,n){return Zt(this.root,t.value,t,n)||[]}getPreInitialState(t,n,r){const{context:i}=this.config,s=Ge({context:typeof i!="function"&&i?i:{},_nodes:[this.root],children:{},status:"active"},this);return typeof i=="function"?ke(s,n,t,[C(({spawn:a,event:c,self:l})=>i({spawn:a,input:c.input,self:l}))],r,void 0):s}getInitialSnapshot(t,n){const r=Wn(n),i=[],s=this.getPreInitialState(t,r,i),o=St([{target:[...rr(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],s,t,r,!0,i),{snapshot:a}=dt(o,r,t,i);return a}start(t){Object.values(t.children).forEach(n=>{n.getSnapshot().status==="active"&&n.start()})}getStateNodeById(t){const n=jt(t),r=n.slice(1),i=st(n[0])?n[0].slice(Ki.length):n[0],s=this.idMap.get(i);if(!s)throw new Error(`Child state node '#${i}' does not exist on machine '${this.id}'`);return We(s,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(t,n){return Vi(t,n)}restoreSnapshot(t,n){const r={},i=t.children;Object.keys(i).forEach(u=>{const f=i[u],h=f.snapshot,p=f.src,y=typeof p=="string"?Lt(this,p):p;if(!y)return;const k=xe(y,{id:u,parent:n.self,syncSnapshot:f.syncSnapshot,snapshot:h,src:p,systemId:f.systemId});r[u]=k});function s(u,f){if(f instanceof qe)return f;try{return u.machine.getStateNodeById(f.id)}catch{}}function o(u,f){if(!f||typeof f!="object")return{};const h={};for(const p in f){const y=f[p];for(const k of y){const N=s(u,k);N&&(h[p]??=[],h[p].push(N))}}return h}const a=o(this.root,t.historyValue),c=Ge({...t,children:r,_nodes:Array.from(Ye(He(this.root,t.value))),historyValue:a},this),l=new Set;function d(u,f){if(!l.has(u)){l.add(u);for(const h in u){const p=u[h];if(p&&typeof p=="object"){if("xstate$$type"in p&&p.xstate$$type===Mt){u[h]=f[p.id];continue}d(p,f)}}}}return d(c.context,r),c}}function lr(e,t){return new Vt(e,t)}var Ji={},ur={exports:{}},dr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Se=W;function Xi(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qi=typeof Object.is=="function"?Object.is:Xi,es=Se.useState,ts=Se.useEffect,ns=Se.useLayoutEffect,rs=Se.useDebugValue;function is(e,t){var n=t(),r=es({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return ns(function(){i.value=n,i.getSnapshot=t,ft(i)&&s({inst:i})},[e,n,t]),ts(function(){return ft(i)&&s({inst:i}),e(function(){ft(i)&&s({inst:i})})},[e]),rs(n),n}function ft(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qi(e,n)}catch{return!0}}function ss(e,t){return t()}var os=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ss:is;dr.useSyncExternalStore=Se.useSyncExternalStore!==void 0?Se.useSyncExternalStore:os;ur.exports=dr;var fr=ur.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot=W,as=fr;function cs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ls=typeof Object.is=="function"?Object.is:cs,us=as.useSyncExternalStore,ds=ot.useRef,fs=ot.useEffect,hs=ot.useMemo,ps=ot.useDebugValue;Ji.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=ds(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=hs(function(){function c(h){if(!l){if(l=!0,d=h,h=r(h),i!==void 0&&o.hasValue){var p=o.value;if(i(p,h))return u=p}return u=h}if(p=u,ls(d,h))return p;var y=r(h);return i!==void 0&&i(p,y)?(d=h,p):(d=h,u=y)}var l=!1,d,u,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,i]);var a=us(e,s[0],s[1]);return fs(function(){o.hasValue=!0,o.value=a},[a]),ps(a),a};const hr=(e,t)=>{t(e);const n=e.getSnapshot().children;n&&Object.values(n).forEach(r=>{hr(r,t)})};function ms(e){const t=[];hr(e,r=>{t.push([r,r.getSnapshot()]),r.observers=new Set});const n=e.system.getSnapshot?.();e.stop(),e.system._snapshot=n,t.forEach(([r,i])=>{r._processingStatus=0,r._snapshot=i})}function gs(e,...[t]){let[[n,r],i]=W.useState(()=>{const s=xe(e,t);return[e.config,s]});if(e.config!==n){const s=xe(e,{...t,snapshot:r.getPersistedSnapshot({__unsafeAllowInlineActors:!0})});i([e.config,s]),r=s}return Yr(()=>{r.logic.implementations=e.implementations}),r}function ys(e,...[t]){const n=gs(e,t),r=W.useCallback(()=>n.getSnapshot(),[n]),i=W.useCallback(o=>{const{unsubscribe:a}=n.subscribe(o);return a},[n]),s=fr.useSyncExternalStore(i,r,r);return W.useEffect(()=>(n.start(),()=>{ms(n)}),[n]),[s,n.send,n]}function pr(e,...[t]){return ys(e,t)}let cn=0;const vs=lr({id:"workspace",initial:"listing",context:{fabrics:[],selectedFabricId:null,errors:[]},states:{listing:{on:{UPDATE_FABRIC_STATUS:{actions:C({fabrics:({context:e,event:t})=>e.fabrics.map(n=>n.id===t.fabricId?{...n,status:t.status,lastModified:new Date}:n)})},CREATE_FABRIC:[{guard:({event:e,context:t})=>{const n=e.name?.trim();return!!(n&&!t.fabrics.some(r=>r.name===n))},actions:C({fabrics:({context:e,event:t})=>{const n={id:`fabric-${Date.now()}-${++cn}`,name:t.name.trim(),status:"draft",createdAt:new Date,lastModified:new Date};return[...e.fabrics,n]},errors:[]})},{target:"error",actions:C({errors:({event:e,context:t})=>e.name?.trim()?t.fabrics.some(n=>n.name===e.name.trim())?["Fabric name must be unique"]:["Invalid fabric name"]:["Fabric name cannot be empty"]})}],SELECT_FABRIC:{target:"selected",actions:C({selectedFabricId:({event:e})=>e.fabricId,errors:[]})},DELETE_FABRIC:{actions:C({fabrics:({context:e,event:t})=>e.fabrics.filter(n=>n.id!==t.fabricId),errors:[]})}}},creating:{on:{LIST_FABRICS:{target:"listing",actions:C({errors:[]})}}},selected:{on:{BACK_TO_LIST:{target:"listing",actions:C({selectedFabricId:null,errors:[]})},UPDATE_FABRIC_STATUS:{actions:C({fabrics:({context:e,event:t})=>e.fabrics.map(n=>n.id===t.fabricId?{...n,status:t.status,lastModified:new Date}:n)})},DELETE_FABRIC:[{guard:({context:e,event:t})=>e.selectedFabricId===t.fabricId,target:"listing",actions:C({fabrics:({context:e,event:t})=>e.fabrics.filter(n=>n.id!==t.fabricId),selectedFabricId:null,errors:[]})},{actions:C({fabrics:({context:e,event:t})=>e.fabrics.filter(n=>n.id!==t.fabricId)})}]}},error:{on:{CREATE_FABRIC:[{guard:({event:e,context:t})=>{const n=e.name?.trim();return!!(n&&!t.fabrics.some(r=>r.name===n))},target:"listing",actions:C({fabrics:({context:e,event:t})=>{const n={id:`fabric-${Date.now()}-${++cn}`,name:t.name.trim(),status:"draft",createdAt:new Date,lastModified:new Date};return[...e.fabrics,n]},errors:[]})},{actions:C({errors:({event:e,context:t})=>e.name?.trim()?t.fabrics.some(n=>n.name===e.name.trim())?["Fabric name must be unique"]:["Invalid fabric name"]:["Fabric name cannot be empty"]})}],LIST_FABRICS:{target:"listing",actions:C({errors:[]})},SELECT_FABRIC:{target:"selected",actions:C({selectedFabricId:({event:e})=>e.fabricId,errors:[]})}}}}});var I;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},e.getValidEnumValues=i=>{const s=e.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return e.objectValues(o)},e.objectValues=i=>e.objectKeys(i).map(function(s){return i[s]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},e.find=(i,s)=>{for(const o of i)if(s(o))return o},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}e.joinValues=r,e.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(I||(I={}));var ln;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(ln||(ln={}));const v=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),K=e=>{switch(typeof e){case"undefined":return v.undefined;case"string":return v.string;case"number":return Number.isNaN(e)?v.nan:v.number;case"boolean":return v.boolean;case"function":return v.function;case"bigint":return v.bigint;case"symbol":return v.symbol;case"object":return Array.isArray(e)?v.array:e===null?v.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?v.promise:typeof Map<"u"&&e instanceof Map?v.map:typeof Set<"u"&&e instanceof Set?v.set:typeof Date<"u"&&e instanceof Date?v.date:v.object;default:return v.unknown}},m=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class H extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(s){return s.message},r={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return i(this),r}static assert(t){if(!(t instanceof H))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];n[s]=n[s]||[],n[s].push(t(i))}else r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}H.create=e=>new H(e);const At=(e,t)=>{let n;switch(e.code){case m.invalid_type:e.received===v.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case m.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,I.jsonStringifyReplacer)}`;break;case m.unrecognized_keys:n=`Unrecognized key(s) in object: ${I.joinValues(e.keys,", ")}`;break;case m.invalid_union:n="Invalid input";break;case m.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${I.joinValues(e.options)}`;break;case m.invalid_enum_value:n=`Invalid enum value. Expected ${I.joinValues(e.options)}, received '${e.received}'`;break;case m.invalid_arguments:n="Invalid function arguments";break;case m.invalid_return_type:n="Invalid function return type";break;case m.invalid_date:n="Invalid date";break;case m.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:I.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case m.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case m.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case m.custom:n="Invalid input";break;case m.invalid_intersection_types:n="Intersection results could not be merged";break;case m.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case m.not_finite:n="Number must be finite";break;default:n=t.defaultError,I.assertNever(e)}return{message:n}};let _s=At;function xs(){return _s}const ws=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,s=[...n,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:t,defaultError:a}).message;return{...i,path:s,message:a}};function g(e,t){const n=xs(),r=ws({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===At?void 0:At].filter(i=>!!i)});e.common.issues.push(r)}class Z{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return w;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const i of n){const s=await i.key,o=await i.value;r.push({key:s,value:o})}return Z.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return w;s.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:t.value,value:r}}}const w=Object.freeze({status:"aborted"}),Re=e=>({status:"dirty",value:e}),U=e=>({status:"valid",value:e}),un=e=>e.status==="aborted",dn=e=>e.status==="dirty",Ae=e=>e.status==="valid",Ke=e=>typeof Promise<"u"&&e instanceof Promise;var _;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(_||(_={}));class ne{constructor(t,n,r,i){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fn=(e,t)=>{if(Ae(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new H(e.common.issues);return this._error=n,this._error}}};function A(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(o,a)=>{const{message:c}=e;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??r??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:c??n??a.defaultError}},description:i}}class E{get description(){return this._def.description}_getType(t){return K(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:K(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Z,ctx:{common:t.parent.common,data:t.data,parsedType:K(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Ke(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:K(t)},i=this._parseSync({data:t,path:r.path,parent:r});return fn(r,i)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:K(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return Ae(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>Ae(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:K(t)},i=this._parse({data:t,path:r.path,parent:r}),s=await(Ke(i)?i:Promise.resolve(i));return fn(r,s)}refine(t,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const o=t(i),a=()=>s.addIssue({code:m.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(t,n){return this._refinement((r,i)=>t(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(t){return new Ee({schema:this,typeName:b.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Q.create(this,this._def)}nullable(){return Ie.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return z.create(this)}promise(){return Qe.create(this,this._def)}or(t){return Je.create([this,t],this._def)}and(t){return Xe.create(this,t,this._def)}transform(t){return new Ee({...A(this._def),schema:this,typeName:b.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Ct({...A(this._def),innerType:this,defaultValue:n,typeName:b.ZodDefault})}brand(){return new Gs({typeName:b.ZodBranded,type:this,...A(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Et({...A(this._def),innerType:this,catchValue:n,typeName:b.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Gt.create(this,t)}readonly(){return It.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const bs=/^c[^\s-]{8,}$/i,ks=/^[0-9a-z]+$/,Ss=/^[0-9A-HJKMNP-TV-Z]{26}$/i,As=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ts=/^[a-z0-9_-]{21}$/i,Cs=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Es=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Is=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Os="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ht;const Ds=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Rs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Fs=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ns=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,js=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ls=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mr="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ms=new RegExp(`^${mr}$`);function gr(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function $s(e){return new RegExp(`^${gr(e)}$`)}function Ps(e){let t=`${mr}T${gr(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Bs(e,t){return!!((t==="v4"||!t)&&Ds.test(e)||(t==="v6"||!t)&&Fs.test(e))}function Zs(e,t){if(!Cs.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function Us(e,t){return!!((t==="v4"||!t)&&Rs.test(e)||(t==="v6"||!t)&&Ns.test(e))}class X extends E{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==v.string){const s=this._getOrReturnCtx(t);return g(s,{code:m.invalid_type,expected:v.string,received:s.parsedType}),w}const r=new Z;let i;for(const s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(i=this._getOrReturnCtx(t,i),g(i,{code:m.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")t.data.length>s.value&&(i=this._getOrReturnCtx(t,i),g(i,{code:m.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const o=t.data.length>s.value,a=t.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(t,i),o?g(i,{code:m.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&g(i,{code:m.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")Is.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"email",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")ht||(ht=new RegExp(Os,"u")),ht.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"emoji",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")As.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"uuid",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")Ts.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"nanoid",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")bs.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"cuid",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")ks.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"cuid2",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")Ss.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"ulid",code:m.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),g(i,{validation:"url",code:m.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"regex",code:m.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?Ps(s).test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?Ms.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?$s(s).test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{code:m.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?Es.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"duration",code:m.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?Bs(t.data,s.version)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"ip",code:m.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?Zs(t.data,s.alg)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"jwt",code:m.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?Us(t.data,s.version)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"cidr",code:m.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?js.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"base64",code:m.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?Ls.test(t.data)||(i=this._getOrReturnCtx(t,i),g(i,{validation:"base64url",code:m.invalid_string,message:s.message}),r.dirty()):I.assertNever(s);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),{validation:n,code:m.invalid_string,..._.errToObj(r)})}_addCheck(t){return new X({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",..._.errToObj(t)})}url(t){return this._addCheck({kind:"url",..._.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",..._.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",..._.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",..._.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",..._.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",..._.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",..._.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",..._.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",..._.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",..._.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",..._.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",..._.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,..._.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,..._.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",..._.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,..._.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,..._.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,..._.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,..._.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,..._.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,..._.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,..._.errToObj(n)})}nonempty(t){return this.min(1,_.errToObj(t))}trim(){return new X({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new X({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new X({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}X.create=e=>new X({checks:[],typeName:b.ZodString,coerce:e?.coerce??!1,...A(e)});function Vs(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,s=Number.parseInt(e.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return s%o/10**i}class Te extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==v.number){const s=this._getOrReturnCtx(t);return g(s,{code:m.invalid_type,expected:v.number,received:s.parsedType}),w}let r;const i=new Z;for(const s of this._def.checks)s.kind==="int"?I.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),g(r,{code:m.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?Vs(t.data,s.value)!==0&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),g(r,{code:m.not_finite,message:s.message}),i.dirty()):I.assertNever(s);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,_.toString(n))}gt(t,n){return this.setLimit("min",t,!1,_.toString(n))}lte(t,n){return this.setLimit("max",t,!0,_.toString(n))}lt(t,n){return this.setLimit("max",t,!1,_.toString(n))}setLimit(t,n,r,i){return new Te({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:_.toString(i)}]})}_addCheck(t){return new Te({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:_.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:_.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:_.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:_.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:_.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:_.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:_.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:_.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:_.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&I.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Te.create=e=>new Te({checks:[],typeName:b.ZodNumber,coerce:e?.coerce||!1,...A(e)});class Ne extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==v.bigint)return this._getInvalidInput(t);let r;const i=new Z;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),g(r,{code:m.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):I.assertNever(s);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return g(n,{code:m.invalid_type,expected:v.bigint,received:n.parsedType}),w}gte(t,n){return this.setLimit("min",t,!0,_.toString(n))}gt(t,n){return this.setLimit("min",t,!1,_.toString(n))}lte(t,n){return this.setLimit("max",t,!0,_.toString(n))}lt(t,n){return this.setLimit("max",t,!1,_.toString(n))}setLimit(t,n,r,i){return new Ne({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:_.toString(i)}]})}_addCheck(t){return new Ne({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:_.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:_.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:_.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:_.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:_.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ne.create=e=>new Ne({checks:[],typeName:b.ZodBigInt,coerce:e?.coerce??!1,...A(e)});class hn extends E{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==v.boolean){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.boolean,received:r.parsedType}),w}return U(t.data)}}hn.create=e=>new hn({typeName:b.ZodBoolean,coerce:e?.coerce||!1,...A(e)});class je extends E{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==v.date){const s=this._getOrReturnCtx(t);return g(s,{code:m.invalid_type,expected:v.date,received:s.parsedType}),w}if(Number.isNaN(t.data.getTime())){const s=this._getOrReturnCtx(t);return g(s,{code:m.invalid_date}),w}const r=new Z;let i;for(const s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(i=this._getOrReturnCtx(t,i),g(i,{code:m.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(i=this._getOrReturnCtx(t,i),g(i,{code:m.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):I.assertNever(s);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new je({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:_.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:_.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}je.create=e=>new je({checks:[],coerce:e?.coerce||!1,typeName:b.ZodDate,...A(e)});class pn extends E{_parse(t){if(this._getType(t)!==v.symbol){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.symbol,received:r.parsedType}),w}return U(t.data)}}pn.create=e=>new pn({typeName:b.ZodSymbol,...A(e)});class mn extends E{_parse(t){if(this._getType(t)!==v.undefined){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.undefined,received:r.parsedType}),w}return U(t.data)}}mn.create=e=>new mn({typeName:b.ZodUndefined,...A(e)});class gn extends E{_parse(t){if(this._getType(t)!==v.null){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.null,received:r.parsedType}),w}return U(t.data)}}gn.create=e=>new gn({typeName:b.ZodNull,...A(e)});class yn extends E{constructor(){super(...arguments),this._any=!0}_parse(t){return U(t.data)}}yn.create=e=>new yn({typeName:b.ZodAny,...A(e)});class vn extends E{constructor(){super(...arguments),this._unknown=!0}_parse(t){return U(t.data)}}vn.create=e=>new vn({typeName:b.ZodUnknown,...A(e)});class re extends E{_parse(t){const n=this._getOrReturnCtx(t);return g(n,{code:m.invalid_type,expected:v.never,received:n.parsedType}),w}}re.create=e=>new re({typeName:b.ZodNever,...A(e)});class _n extends E{_parse(t){if(this._getType(t)!==v.undefined){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.void,received:r.parsedType}),w}return U(t.data)}}_n.create=e=>new _n({typeName:b.ZodVoid,...A(e)});class z extends E{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==v.array)return g(n,{code:m.invalid_type,expected:v.array,received:n.parsedType}),w;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,a=n.data.length<i.exactLength.value;(o||a)&&(g(n,{code:o?m.too_big:m.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(g(n,{code:m.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(g(n,{code:m.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>i.type._parseAsync(new ne(n,o,n.path,a)))).then(o=>Z.mergeArray(r,o));const s=[...n.data].map((o,a)=>i.type._parseSync(new ne(n,o,n.path,a)));return Z.mergeArray(r,s)}get element(){return this._def.type}min(t,n){return new z({...this._def,minLength:{value:t,message:_.toString(n)}})}max(t,n){return new z({...this._def,maxLength:{value:t,message:_.toString(n)}})}length(t,n){return new z({...this._def,exactLength:{value:t,message:_.toString(n)}})}nonempty(t){return this.min(1,t)}}z.create=(e,t)=>new z({type:e,minLength:null,maxLength:null,exactLength:null,typeName:b.ZodArray,...A(t)});function me(e){if(e instanceof D){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Q.create(me(r))}return new D({...e._def,shape:()=>t})}else return e instanceof z?new z({...e._def,type:me(e.element)}):e instanceof Q?Q.create(me(e.unwrap())):e instanceof Ie?Ie.create(me(e.unwrap())):e instanceof ue?ue.create(e.items.map(t=>me(t))):e}class D extends E{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=I.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==v.object){const l=this._getOrReturnCtx(t);return g(l,{code:m.invalid_type,expected:v.object,received:l.parsedType}),w}const{status:r,ctx:i}=this._processInputParams(t),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof re&&this._def.unknownKeys==="strip"))for(const l in i.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const d=s[l],u=i.data[l];c.push({key:{status:"valid",value:l},value:d._parse(new ne(i,u,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof re){const l=this._def.unknownKeys;if(l==="passthrough")for(const d of a)c.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(l==="strict")a.length>0&&(g(i,{code:m.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const d of a){const u=i.data[d];c.push({key:{status:"valid",value:d},value:l._parse(new ne(i,u,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const l=[];for(const d of c){const u=await d.key,f=await d.value;l.push({key:u,value:f,alwaysSet:d.alwaysSet})}return l}).then(l=>Z.mergeObjectSync(r,l)):Z.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return _.errToObj,new D({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const i=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:_.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new D({...this._def,unknownKeys:"strip"})}passthrough(){return new D({...this._def,unknownKeys:"passthrough"})}extend(t){return new D({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new D({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:b.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new D({...this._def,catchall:t})}pick(t){const n={};for(const r of I.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new D({...this._def,shape:()=>n})}omit(t){const n={};for(const r of I.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new D({...this._def,shape:()=>n})}deepPartial(){return me(this)}partial(t){const n={};for(const r of I.objectKeys(this.shape)){const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}return new D({...this._def,shape:()=>n})}required(t){const n={};for(const r of I.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Q;)s=s._def.innerType;n[r]=s}return new D({...this._def,shape:()=>n})}keyof(){return yr(I.objectKeys(this.shape))}}D.create=(e,t)=>new D({shape:()=>e,unknownKeys:"strip",catchall:re.create(),typeName:b.ZodObject,...A(t)});D.strictCreate=(e,t)=>new D({shape:()=>e,unknownKeys:"strict",catchall:re.create(),typeName:b.ZodObject,...A(t)});D.lazycreate=(e,t)=>new D({shape:e,unknownKeys:"strip",catchall:re.create(),typeName:b.ZodObject,...A(t)});class Je extends E{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new H(a.ctx.common.issues));return g(n,{code:m.invalid_union,unionErrors:o}),w}if(n.common.async)return Promise.all(r.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},d=c._parseSync({data:n.data,path:n.path,parent:l});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(c=>new H(c));return g(n,{code:m.invalid_union,unionErrors:a}),w}}get options(){return this._def.options}}Je.create=(e,t)=>new Je({options:e,typeName:b.ZodUnion,...A(t)});function Tt(e,t){const n=K(e),r=K(t);if(e===t)return{valid:!0,data:e};if(n===v.object&&r===v.object){const i=I.objectKeys(t),s=I.objectKeys(e).filter(a=>i.indexOf(a)!==-1),o={...e,...t};for(const a of s){const c=Tt(e[a],t[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===v.array&&r===v.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let s=0;s<e.length;s++){const o=e[s],a=t[s],c=Tt(o,a);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return n===v.date&&r===v.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Xe extends E{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=(s,o)=>{if(un(s)||un(o))return w;const a=Tt(s.value,o.value);return a.valid?((dn(s)||dn(o))&&n.dirty(),{status:n.value,value:a.data}):(g(r,{code:m.invalid_intersection_types}),w)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Xe.create=(e,t,n)=>new Xe({left:e,right:t,typeName:b.ZodIntersection,...A(n)});class ue extends E{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==v.array)return g(r,{code:m.invalid_type,expected:v.array,received:r.parsedType}),w;if(r.data.length<this._def.items.length)return g(r,{code:m.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),w;!this._def.rest&&r.data.length>this._def.items.length&&(g(r,{code:m.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new ne(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>Z.mergeArray(n,o)):Z.mergeArray(n,s)}get items(){return this._def.items}rest(t){return new ue({...this._def,rest:t})}}ue.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ue({items:e,typeName:b.ZodTuple,rest:null,...A(t)})};class xn extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==v.map)return g(r,{code:m.invalid_type,expected:v.map,received:r.parsedType}),w;const i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:i._parse(new ne(r,a,r.path,[l,"key"])),value:s._parse(new ne(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,d=await c.value;if(l.status==="aborted"||d.status==="aborted")return w;(l.status==="dirty"||d.status==="dirty")&&n.dirty(),a.set(l.value,d.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,d=c.value;if(l.status==="aborted"||d.status==="aborted")return w;(l.status==="dirty"||d.status==="dirty")&&n.dirty(),a.set(l.value,d.value)}return{status:n.value,value:a}}}}xn.create=(e,t,n)=>new xn({valueType:t,keyType:e,typeName:b.ZodMap,...A(n)});class Le extends E{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==v.set)return g(r,{code:m.invalid_type,expected:v.set,received:r.parsedType}),w;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(g(r,{code:m.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(g(r,{code:m.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function o(c){const l=new Set;for(const d of c){if(d.status==="aborted")return w;d.status==="dirty"&&n.dirty(),l.add(d.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>s._parse(new ne(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(t,n){return new Le({...this._def,minSize:{value:t,message:_.toString(n)}})}max(t,n){return new Le({...this._def,maxSize:{value:t,message:_.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Le.create=(e,t)=>new Le({valueType:e,minSize:null,maxSize:null,typeName:b.ZodSet,...A(t)});class wn extends E{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}wn.create=(e,t)=>new wn({getter:e,typeName:b.ZodLazy,...A(t)});class bn extends E{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return g(n,{received:n.data,code:m.invalid_literal,expected:this._def.value}),w}return{status:"valid",value:t.data}}get value(){return this._def.value}}bn.create=(e,t)=>new bn({value:e,typeName:b.ZodLiteral,...A(t)});function yr(e,t){return new Ce({values:e,typeName:b.ZodEnum,...A(t)})}class Ce extends E{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return g(n,{expected:I.joinValues(r),received:n.parsedType,code:m.invalid_type}),w}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return g(n,{received:n.data,code:m.invalid_enum_value,options:r}),w}return U(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Ce.create(t,{...this._def,...n})}exclude(t,n=this._def){return Ce.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Ce.create=yr;class kn extends E{_parse(t){const n=I.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==v.string&&r.parsedType!==v.number){const i=I.objectValues(n);return g(r,{expected:I.joinValues(i),received:r.parsedType,code:m.invalid_type}),w}if(this._cache||(this._cache=new Set(I.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const i=I.objectValues(n);return g(r,{received:r.data,code:m.invalid_enum_value,options:i}),w}return U(t.data)}get enum(){return this._def.values}}kn.create=(e,t)=>new kn({values:e,typeName:b.ZodNativeEnum,...A(t)});class Qe extends E{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==v.promise&&n.common.async===!1)return g(n,{code:m.invalid_type,expected:v.promise,received:n.parsedType}),w;const r=n.parsedType===v.promise?n.data:Promise.resolve(n.data);return U(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Qe.create=(e,t)=>new Qe({type:e,typeName:b.ZodPromise,...A(t)});class Ee extends E{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===b.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=this._def.effect||null,s={addIssue:o=>{g(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(r.data,s);if(r.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return w;const c=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return c.status==="aborted"?w:c.status==="dirty"||n.value==="dirty"?Re(c.value):c});{if(n.value==="aborted")return w;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?w:a.status==="dirty"||n.value==="dirty"?Re(a.value):a}}if(i.type==="refinement"){const o=a=>{const c=i.refinement(a,s);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?w:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?w:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ae(o))return w;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Ae(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:n.value,value:a})):w);I.assertNever(i)}}Ee.create=(e,t,n)=>new Ee({schema:e,typeName:b.ZodEffects,effect:t,...A(n)});Ee.createWithPreprocess=(e,t,n)=>new Ee({schema:t,effect:{type:"preprocess",transform:e},typeName:b.ZodEffects,...A(n)});class Q extends E{_parse(t){return this._getType(t)===v.undefined?U(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Q.create=(e,t)=>new Q({innerType:e,typeName:b.ZodOptional,...A(t)});class Ie extends E{_parse(t){return this._getType(t)===v.null?U(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ie.create=(e,t)=>new Ie({innerType:e,typeName:b.ZodNullable,...A(t)});class Ct extends E{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===v.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ct.create=(e,t)=>new Ct({innerType:e,typeName:b.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...A(t)});class Et extends E{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ke(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new H(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new H(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Et.create=(e,t)=>new Et({innerType:e,typeName:b.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...A(t)});class Sn extends E{_parse(t){if(this._getType(t)!==v.nan){const r=this._getOrReturnCtx(t);return g(r,{code:m.invalid_type,expected:v.nan,received:r.parsedType}),w}return{status:"valid",value:t.data}}}Sn.create=e=>new Sn({typeName:b.ZodNaN,...A(e)});class Gs extends E{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Gt extends E{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?w:s.status==="dirty"?(n.dirty(),Re(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?w:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new Gt({in:t,out:n,typeName:b.ZodPipeline})}}class It extends E{_parse(t){const n=this._def.innerType._parse(t),r=i=>(Ae(i)&&(i.value=Object.freeze(i.value)),i);return Ke(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}It.create=(e,t)=>new It({innerType:e,typeName:b.ZodReadonly,...A(t)});var b;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(b||(b={}));const M=X.create,ae=Te.create,zs=je.create;re.create;const Ve=z.create,V=D.create;Je.create;Xe.create;ue.create;const Ys=Ce.create;Qe.create;Q.create;Ie.create;V({name:M().min(1,"Fabric name is required"),spineModelId:M().min(1,"Spine model ID is required"),leafModelId:M().min(1,"Leaf model ID is required"),uplinksPerLeaf:ae().int().min(2,"Must have at least 2 uplinks per leaf").refine(e=>e%2===0,{message:"Uplinks per leaf must be even for proper distribution"}),endpointProfile:V({name:M(),portsPerEndpoint:ae().int().min(1)}),endpointCount:ae().int().min(1,"Must have at least 1 endpoint")});const Ws=(e,t)=>{const n=Array.from({length:t.spinesNeeded},(o,a)=>({id:`spine-${a+1}`,model:e.spineModelId,ports:32})),r=Array.from({length:t.leavesNeeded},(o,a)=>({id:`leaf-${a+1}`,model:e.leafModelId,ports:48})),i=Array.from({length:e.endpointCount},(o,a)=>({id:`server-${a+1}`,type:e.endpointProfile.name,connections:e.endpointProfile.portsPerEndpoint})),s=[];return r.forEach((o,a)=>{for(let c=0;c<e.uplinksPerLeaf;c++){const l=(a*e.uplinksPerLeaf+c)%n.length;s.push({from:{device:o.id,port:`uplink-${c+1}`},to:{device:n[l].id,port:`downlink-${s.length+1}`},type:"uplink"})}}),{devices:{spines:n,leaves:r,servers:i},connections:s,metadata:{generatedAt:new Date,fabricName:e.name,totalDevices:n.length+r.length+i.length}}};function Hs(e){const[t,n]=[48,32],r=t-e.uplinksPerLeaf,i=qs(e.endpointCount,r),s=Ks(i,e.uplinksPerLeaf),o=i*t+s*n,a=e.endpointCount+i*e.uplinksPerLeaf*2,c=Js(i*e.uplinksPerLeaf,e.endpointCount),l=[];return i===0&&l.push("No leaves computed"),s===0&&l.push("No spines computed"),e.uplinksPerLeaf>t/2&&l.push("Too many uplinks per leaf"),c>4&&l.push(`Oversubscription too high: ${c.toFixed(2)}:1`),{leavesNeeded:i,spinesNeeded:s,totalPorts:o,usedPorts:a,oversubscriptionRatio:c,isValid:l.length===0,validationErrors:l}}const qs=(e,t)=>t<=0||e<=0?0:Math.ceil(e/t),Ks=(e,t)=>e<=0||t<=0?0:Math.max(1,Math.ceil(e*t/32)),Js=(e,t)=>e<=0?0:t/e;/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function vr(e){return typeof e>"u"||e===null}function Xs(e){return typeof e=="object"&&e!==null}function Qs(e){return Array.isArray(e)?e:vr(e)?[]:[e]}function eo(e,t){var n,r,i,s;if(t)for(s=Object.keys(t),n=0,r=s.length;n<r;n+=1)i=s[n],e[i]=t[i];return e}function to(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function no(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var ro=vr,io=Xs,so=Qs,oo=to,ao=no,co=eo,F={isNothing:ro,isObject:io,toArray:so,repeat:oo,isNegativeZero:ao,extend:co};function _r(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function Me(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=_r(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Me.prototype=Object.create(Error.prototype);Me.prototype.constructor=Me;Me.prototype.toString=function(t){return this.name+": "+_r(this,t)};var P=Me;function pt(e,t,n,r,i){var s="",o="",a=Math.floor(i/2)-1;return r-t>a&&(s=" ... ",t=r-a+s.length),n-r>a&&(o=" ...",n=r+a-o.length),{str:s+e.slice(t,n).replace(/\t/g,"→")+o,pos:r-t+s.length}}function mt(e,t){return F.repeat(" ",t-e.length)+e}function lo(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],s,o=-1;s=n.exec(e.buffer);)i.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var a="",c,l,d=Math.min(e.line+t.linesAfter,i.length).toString().length,u=t.maxLength-(t.indent+d+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)l=pt(e.buffer,r[o-c],i[o-c],e.position-(r[o]-r[o-c]),u),a=F.repeat(" ",t.indent)+mt((e.line-c+1).toString(),d)+" | "+l.str+`
`+a;for(l=pt(e.buffer,r[o],i[o],e.position,u),a+=F.repeat(" ",t.indent)+mt((e.line+1).toString(),d)+" | "+l.str+`
`,a+=F.repeat("-",t.indent+d+3+l.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)l=pt(e.buffer,r[o+c],i[o+c],e.position-(r[o]-r[o+c]),u),a+=F.repeat(" ",t.indent)+mt((e.line+c+1).toString(),d)+" | "+l.str+`
`;return a.replace(/\n$/,"")}var uo=lo,fo=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],ho=["scalar","sequence","mapping"];function po(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function mo(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(fo.indexOf(n)===-1)throw new P('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=po(t.styleAliases||null),ho.indexOf(this.kind)===-1)throw new P('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var j=mo;function An(e,t){var n=[];return e[t].forEach(function(r){var i=n.length;n.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=o)}),n[i]=r}),n}function go(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function Ot(e){return this.extend(e)}Ot.prototype.extend=function(t){var n=[],r=[];if(t instanceof j)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new P("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(s){if(!(s instanceof j))throw new P("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new P("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new P("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof j))throw new P("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Ot.prototype);return i.implicit=(this.implicit||[]).concat(n),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=An(i,"implicit"),i.compiledExplicit=An(i,"explicit"),i.compiledTypeMap=go(i.compiledImplicit,i.compiledExplicit),i};var yo=Ot,vo=new j("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),_o=new j("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),xo=new j("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),wo=new yo({explicit:[vo,_o,xo]});function bo(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function ko(){return null}function So(e){return e===null}var Ao=new j("tag:yaml.org,2002:null",{kind:"scalar",resolve:bo,construct:ko,predicate:So,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function To(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function Co(e){return e==="true"||e==="True"||e==="TRUE"}function Eo(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Io=new j("tag:yaml.org,2002:bool",{kind:"scalar",resolve:To,construct:Co,predicate:Eo,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Oo(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Do(e){return 48<=e&&e<=55}function Ro(e){return 48<=e&&e<=57}function Fo(e){if(e===null)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;if(i=e[n],(i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!Oo(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!Do(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(!Ro(e.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}function No(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function jo(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!F.isNegativeZero(e)}var Lo=new j("tag:yaml.org,2002:int",{kind:"scalar",resolve:Fo,construct:No,predicate:jo,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Mo=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function $o(e){return!(e===null||!Mo.test(e)||e[e.length-1]==="_")}function Po(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var Bo=/^[-+]?[0-9]+e/;function Zo(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(F.isNegativeZero(e))return"-0.0";return n=e.toString(10),Bo.test(n)?n.replace("e",".e"):n}function Uo(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||F.isNegativeZero(e))}var Vo=new j("tag:yaml.org,2002:float",{kind:"scalar",resolve:$o,construct:Po,predicate:Uo,represent:Zo,defaultStyle:"lowercase"}),Go=wo.extend({implicit:[Ao,Io,Lo,Vo]}),zo=Go,xr=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),wr=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Yo(e){return e===null?!1:xr.exec(e)!==null||wr.exec(e)!==null}function Wo(e){var t,n,r,i,s,o,a,c=0,l=null,d,u,f;if(t=xr.exec(e),t===null&&(t=wr.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(s=+t[4],o=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=+t[10],u=+(t[11]||0),l=(d*60+u)*6e4,t[9]==="-"&&(l=-l)),f=new Date(Date.UTC(n,r,i,s,o,a,c)),l&&f.setTime(f.getTime()-l),f}function Ho(e){return e.toISOString()}var qo=new j("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Yo,construct:Wo,instanceOf:Date,represent:Ho});function Ko(e){return e==="<<"||e===null}var Jo=new j("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Ko}),zt=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Xo(e){if(e===null)return!1;var t,n,r=0,i=e.length,s=zt;for(n=0;n<i;n++)if(t=s.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function Qo(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,s=zt,o=0,a=[];for(t=0;t<i;t++)t%4===0&&t&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|s.indexOf(r.charAt(t));return n=i%4*6,n===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):n===18?(a.push(o>>10&255),a.push(o>>2&255)):n===12&&a.push(o>>4&255),new Uint8Array(a)}function ea(e){var t="",n=0,r,i,s=e.length,o=zt;for(r=0;r<s;r++)r%3===0&&r&&(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]),n=(n<<8)+e[r];return i=s%3,i===0?(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]):i===2?(t+=o[n>>10&63],t+=o[n>>4&63],t+=o[n<<2&63],t+=o[64]):i===1&&(t+=o[n>>2&63],t+=o[n<<4&63],t+=o[64],t+=o[64]),t}function ta(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var na=new j("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Xo,construct:Qo,predicate:ta,represent:ea}),ra=Object.prototype.hasOwnProperty,ia=Object.prototype.toString;function sa(e){if(e===null)return!0;var t=[],n,r,i,s,o,a=e;for(n=0,r=a.length;n<r;n+=1){if(i=a[n],o=!1,ia.call(i)!=="[object Object]")return!1;for(s in i)if(ra.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function oa(e){return e!==null?e:[]}var aa=new j("tag:yaml.org,2002:omap",{kind:"sequence",resolve:sa,construct:oa}),ca=Object.prototype.toString;function la(e){if(e===null)return!0;var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(r=o[t],ca.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[t]=[i[0],r[i[0]]]}return!0}function ua(e){if(e===null)return[];var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1)r=o[t],i=Object.keys(r),s[t]=[i[0],r[i[0]]];return s}var da=new j("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:la,construct:ua}),fa=Object.prototype.hasOwnProperty;function ha(e){if(e===null)return!0;var t,n=e;for(t in n)if(fa.call(n,t)&&n[t]!==null)return!1;return!0}function pa(e){return e!==null?e:{}}var ma=new j("tag:yaml.org,2002:set",{kind:"mapping",resolve:ha,construct:pa}),br=zo.extend({implicit:[qo,Jo],explicit:[na,aa,da,ma]}),ie=Object.prototype.hasOwnProperty,et=1,kr=2,Sr=3,tt=4,gt=1,ga=2,Tn=3,ya=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,va=/[\x85\u2028\u2029]/,_a=/[,\[\]\{\}]/,Ar=/^(?:!|!!|![a-z\-]+!)$/i,Tr=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Cn(e){return Object.prototype.toString.call(e)}function Y(e){return e===10||e===13}function ce(e){return e===9||e===32}function B(e){return e===9||e===32||e===10||e===13}function ve(e){return e===44||e===91||e===93||e===123||e===125}function xa(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function wa(e){return e===120?2:e===117?4:e===85?8:0}function ba(e){return 48<=e&&e<=57?e-48:-1}function En(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function ka(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var Cr=new Array(256),Er=new Array(256);for(var he=0;he<256;he++)Cr[he]=En(he)?1:0,Er[he]=En(he);function Sa(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||br,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Ir(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=uo(n),new P(t,n)}function x(e,t){throw Ir(e,t)}function nt(e,t){e.onWarning&&e.onWarning.call(null,Ir(e,t))}var In={YAML:function(t,n,r){var i,s,o;t.version!==null&&x(t,"duplication of %YAML directive"),r.length!==1&&x(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&x(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&x(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&nt(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var i,s;r.length!==2&&x(t,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],Ar.test(i)||x(t,"ill-formed tag handle (first argument) of the TAG directive"),ie.call(t.tagMap,i)&&x(t,'there is a previously declared suffix for "'+i+'" tag handle'),Tr.test(s)||x(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{x(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function ee(e,t,n,r){var i,s,o,a;if(t<n){if(a=e.input.slice(t,n),r)for(i=0,s=a.length;i<s;i+=1)o=a.charCodeAt(i),o===9||32<=o&&o<=1114111||x(e,"expected valid JSON character");else ya.test(a)&&x(e,"the stream contains non-printable characters");e.result+=a}}function On(e,t,n,r){var i,s,o,a;for(F.isObject(n)||x(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),o=0,a=i.length;o<a;o+=1)s=i[o],ie.call(t,s)||(t[s]=n[s],r[s]=!0)}function _e(e,t,n,r,i,s,o,a,c){var l,d;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),l=0,d=i.length;l<d;l+=1)Array.isArray(i[l])&&x(e,"nested arrays are not supported inside keys"),typeof i=="object"&&Cn(i[l])==="[object Object]"&&(i[l]="[object Object]");if(typeof i=="object"&&Cn(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(l=0,d=s.length;l<d;l+=1)On(e,t,s[l],n);else On(e,t,s,n);else!e.json&&!ie.call(n,i)&&ie.call(t,i)&&(e.line=o||e.line,e.lineStart=a||e.lineStart,e.position=c||e.position,x(e,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[i]=s,delete n[i];return t}function Yt(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):x(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function R(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;ce(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Y(i))for(Yt(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&nt(e,"deficient indentation"),r}function at(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||B(n)))}function Wt(e,t){t===1?e.result+=" ":t>1&&(e.result+=F.repeat(`
`,t-1))}function Aa(e,t,n){var r,i,s,o,a,c,l,d,u=e.kind,f=e.result,h;if(h=e.input.charCodeAt(e.position),B(h)||ve(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=e.input.charCodeAt(e.position+1),B(i)||n&&ve(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,a=!1;h!==0;){if(h===58){if(i=e.input.charCodeAt(e.position+1),B(i)||n&&ve(i))break}else if(h===35){if(r=e.input.charCodeAt(e.position-1),B(r))break}else{if(e.position===e.lineStart&&at(e)||n&&ve(h))break;if(Y(h))if(c=e.line,l=e.lineStart,d=e.lineIndent,R(e,!1,-1),e.lineIndent>=t){a=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=l,e.lineIndent=d;break}}a&&(ee(e,s,o,!1),Wt(e,e.line-c),s=o=e.position,a=!1),ce(h)||(o=e.position+1),h=e.input.charCodeAt(++e.position)}return ee(e,s,o,!1),e.result?!0:(e.kind=u,e.result=f,!1)}function Ta(e,t){var n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(ee(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else Y(n)?(ee(e,r,i,!0),Wt(e,R(e,!1,t)),r=i=e.position):e.position===e.lineStart&&at(e)?x(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);x(e,"unexpected end of the stream within a single quoted scalar")}function Ca(e,t){var n,r,i,s,o,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return ee(e,n,e.position,!0),e.position++,!0;if(a===92){if(ee(e,n,e.position,!0),a=e.input.charCodeAt(++e.position),Y(a))R(e,!1,t);else if(a<256&&Cr[a])e.result+=Er[a],e.position++;else if((o=wa(a))>0){for(i=o,s=0;i>0;i--)a=e.input.charCodeAt(++e.position),(o=xa(a))>=0?s=(s<<4)+o:x(e,"expected hexadecimal character");e.result+=ka(s),e.position++}else x(e,"unknown escape sequence");n=r=e.position}else Y(a)?(ee(e,n,r,!0),Wt(e,R(e,!1,t)),n=r=e.position):e.position===e.lineStart&&at(e)?x(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}x(e,"unexpected end of the stream within a double quoted scalar")}function Ea(e,t){var n=!0,r,i,s,o=e.tag,a,c=e.anchor,l,d,u,f,h,p=Object.create(null),y,k,N,T;if(T=e.input.charCodeAt(e.position),T===91)d=93,h=!1,a=[];else if(T===123)d=125,h=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),T=e.input.charCodeAt(++e.position);T!==0;){if(R(e,!0,t),T=e.input.charCodeAt(e.position),T===d)return e.position++,e.tag=o,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=a,!0;n?T===44&&x(e,"expected the node content, but found ','"):x(e,"missed comma between flow collection entries"),k=y=N=null,u=f=!1,T===63&&(l=e.input.charCodeAt(e.position+1),B(l)&&(u=f=!0,e.position++,R(e,!0,t))),r=e.line,i=e.lineStart,s=e.position,Oe(e,t,et,!1,!0),k=e.tag,y=e.result,R(e,!0,t),T=e.input.charCodeAt(e.position),(f||e.line===r)&&T===58&&(u=!0,T=e.input.charCodeAt(++e.position),R(e,!0,t),Oe(e,t,et,!1,!0),N=e.result),h?_e(e,a,p,k,y,N,r,i,s):u?a.push(_e(e,null,p,k,y,N,r,i,s)):a.push(y),R(e,!0,t),T=e.input.charCodeAt(e.position),T===44?(n=!0,T=e.input.charCodeAt(++e.position)):n=!1}x(e,"unexpected end of the stream within a flow collection")}function Ia(e,t){var n,r,i=gt,s=!1,o=!1,a=t,c=0,l=!1,d,u;if(u=e.input.charCodeAt(e.position),u===124)r=!1;else if(u===62)r=!0;else return!1;for(e.kind="scalar",e.result="";u!==0;)if(u=e.input.charCodeAt(++e.position),u===43||u===45)gt===i?i=u===43?Tn:ga:x(e,"repeat of a chomping mode identifier");else if((d=ba(u))>=0)d===0?x(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?x(e,"repeat of an indentation width identifier"):(a=t+d-1,o=!0);else break;if(ce(u)){do u=e.input.charCodeAt(++e.position);while(ce(u));if(u===35)do u=e.input.charCodeAt(++e.position);while(!Y(u)&&u!==0)}for(;u!==0;){for(Yt(e),e.lineIndent=0,u=e.input.charCodeAt(e.position);(!o||e.lineIndent<a)&&u===32;)e.lineIndent++,u=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>a&&(a=e.lineIndent),Y(u)){c++;continue}if(e.lineIndent<a){i===Tn?e.result+=F.repeat(`
`,s?1+c:c):i===gt&&s&&(e.result+=`
`);break}for(r?ce(u)?(l=!0,e.result+=F.repeat(`
`,s?1+c:c)):l?(l=!1,e.result+=F.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=F.repeat(`
`,c):e.result+=F.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,n=e.position;!Y(u)&&u!==0;)u=e.input.charCodeAt(++e.position);ee(e,n,e.position,!1)}return!0}function Dn(e,t){var n,r=e.tag,i=e.anchor,s=[],o,a=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,x(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!B(o))));){if(a=!0,e.position++,R(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(n=e.line,Oe(e,t,Sr,!1,!0),s.push(e.result),R(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&c!==0)x(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return a?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function Oa(e,t,n){var r,i,s,o,a,c,l=e.tag,d=e.anchor,u={},f=Object.create(null),h=null,p=null,y=null,k=!1,N=!1,T;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=u),T=e.input.charCodeAt(e.position);T!==0;){if(!k&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,x(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(T===63||T===58)&&B(r))T===63?(k&&(_e(e,u,f,h,p,null,o,a,c),h=p=y=null),N=!0,k=!0,i=!0):k?(k=!1,i=!0):x(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,T=r;else{if(o=e.line,a=e.lineStart,c=e.position,!Oe(e,n,kr,!1,!0))break;if(e.line===s){for(T=e.input.charCodeAt(e.position);ce(T);)T=e.input.charCodeAt(++e.position);if(T===58)T=e.input.charCodeAt(++e.position),B(T)||x(e,"a whitespace character is expected after the key-value separator within a block mapping"),k&&(_e(e,u,f,h,p,null,o,a,c),h=p=y=null),N=!0,k=!1,i=!1,h=e.tag,p=e.result;else if(N)x(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=l,e.anchor=d,!0}else if(N)x(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=l,e.anchor=d,!0}if((e.line===s||e.lineIndent>t)&&(k&&(o=e.line,a=e.lineStart,c=e.position),Oe(e,t,tt,!0,i)&&(k?p=e.result:y=e.result),k||(_e(e,u,f,h,p,y,o,a,c),h=p=y=null),R(e,!0,-1),T=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&T!==0)x(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return k&&_e(e,u,f,h,p,null,o,a,c),N&&(e.tag=l,e.anchor=d,e.kind="mapping",e.result=u),N}function Da(e){var t,n=!1,r=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&x(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(n=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):x(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!B(o);)o===33&&(r?x(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),Ar.test(i)||x(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),_a.test(s)&&x(e,"tag suffix cannot contain flow indicator characters")}s&&!Tr.test(s)&&x(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{x(e,"tag name is malformed: "+s)}return n?e.tag=s:ie.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:x(e,'undeclared tag handle "'+i+'"'),!0}function Ra(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&x(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!B(n)&&!ve(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&x(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Fa(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!B(r)&&!ve(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&x(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),ie.call(e.anchorMap,n)||x(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],R(e,!0,-1),!0}function Oe(e,t,n,r,i){var s,o,a,c=1,l=!1,d=!1,u,f,h,p,y,k;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=a=tt===n||Sr===n,r&&R(e,!0,-1)&&(l=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;Da(e)||Ra(e);)R(e,!0,-1)?(l=!0,a=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):a=!1;if(a&&(a=l||i),(c===1||tt===n)&&(et===n||kr===n?y=t:y=t+1,k=e.position-e.lineStart,c===1?a&&(Dn(e,k)||Oa(e,k,y))||Ea(e,y)?d=!0:(o&&Ia(e,y)||Ta(e,y)||Ca(e,y)?d=!0:Fa(e)?(d=!0,(e.tag!==null||e.anchor!==null)&&x(e,"alias node should not have any properties")):Aa(e,y,et===n)&&(d=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(d=a&&Dn(e,k))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&x(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),u=0,f=e.implicitTypes.length;u<f;u+=1)if(p=e.implicitTypes[u],p.resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(ie.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,h=e.typeMap.multi[e.kind||"fallback"],u=0,f=h.length;u<f;u+=1)if(e.tag.slice(0,h[u].tag.length)===h[u].tag){p=h[u];break}p||x(e,"unknown tag !<"+e.tag+">"),e.result!==null&&p.kind!==e.kind&&x(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):x(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||d}function Na(e){var t=e.position,n,r,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(R(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!B(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),i=[],r.length<1&&x(e,"directive name must not be less than one character in length");o!==0;){for(;ce(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Y(o));break}if(Y(o))break;for(n=e.position;o!==0&&!B(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}o!==0&&Yt(e),ie.call(In,r)?In[r](e,r,i):nt(e,'unknown document directive "'+r+'"')}if(R(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,R(e,!0,-1)):s&&x(e,"directives end mark is expected"),Oe(e,e.lineIndent-1,tt,!1,!0),R(e,!0,-1),e.checkLineBreaks&&va.test(e.input.slice(t,e.position))&&nt(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&at(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,R(e,!0,-1));return}if(e.position<e.length-1)x(e,"end of the stream or a document separator is expected");else return}function ja(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new Sa(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,x(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Na(n);return n.documents}function La(e,t){var n=ja(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new P("expected a single document in the stream, but found more")}}var Ma=La,$a={load:Ma},Or=Object.prototype.toString,Dr=Object.prototype.hasOwnProperty,Ht=65279,Pa=9,$e=10,Ba=13,Za=32,Ua=33,Va=34,Dt=35,Ga=37,za=38,Ya=39,Wa=42,Rr=44,Ha=45,rt=58,qa=61,Ka=62,Ja=63,Xa=64,Fr=91,Nr=93,Qa=96,jr=123,ec=124,Lr=125,L={};L[0]="\\0";L[7]="\\a";L[8]="\\b";L[9]="\\t";L[10]="\\n";L[11]="\\v";L[12]="\\f";L[13]="\\r";L[27]="\\e";L[34]='\\"';L[92]="\\\\";L[133]="\\N";L[160]="\\_";L[8232]="\\L";L[8233]="\\P";var tc=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],nc=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function rc(e,t){var n,r,i,s,o,a,c;if(t===null)return{};for(n={},r=Object.keys(t),i=0,s=r.length;i<s;i+=1)o=r[i],a=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&Dr.call(c.styleAliases,a)&&(a=c.styleAliases[a]),n[o]=a;return n}function ic(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new P("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+F.repeat("0",r-t.length)+t}var sc=1,Pe=2;function oc(e){this.schema=e.schema||br,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=F.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=rc(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Pe:sc,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Rn(e,t){for(var n=F.repeat(" ",t),r=0,i=-1,s="",o,a=e.length;r<a;)i=e.indexOf(`
`,r),i===-1?(o=e.slice(r),r=a):(o=e.slice(r,i+1),r=i+1),o.length&&o!==`
`&&(s+=n),s+=o;return s}function Rt(e,t){return`
`+F.repeat(" ",e.indent*t)}function ac(e,t){var n,r,i;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(i=e.implicitTypes[n],i.resolve(t))return!0;return!1}function it(e){return e===Za||e===Pa}function Be(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Ht||65536<=e&&e<=1114111}function Fn(e){return Be(e)&&e!==Ht&&e!==Ba&&e!==$e}function Nn(e,t,n){var r=Fn(e),i=r&&!it(e);return(n?r:r&&e!==Rr&&e!==Fr&&e!==Nr&&e!==jr&&e!==Lr)&&e!==Dt&&!(t===rt&&!i)||Fn(t)&&!it(t)&&e===Dt||t===rt&&i}function cc(e){return Be(e)&&e!==Ht&&!it(e)&&e!==Ha&&e!==Ja&&e!==rt&&e!==Rr&&e!==Fr&&e!==Nr&&e!==jr&&e!==Lr&&e!==Dt&&e!==za&&e!==Wa&&e!==Ua&&e!==ec&&e!==qa&&e!==Ka&&e!==Ya&&e!==Va&&e!==Ga&&e!==Xa&&e!==Qa}function lc(e){return!it(e)&&e!==rt}function Fe(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function Mr(e){var t=/^\n* /;return t.test(e)}var $r=1,Ft=2,Pr=3,Br=4,ge=5;function uc(e,t,n,r,i,s,o,a){var c,l=0,d=null,u=!1,f=!1,h=r!==-1,p=-1,y=cc(Fe(e,0))&&lc(Fe(e,e.length-1));if(t||o)for(c=0;c<e.length;l>=65536?c+=2:c++){if(l=Fe(e,c),!Be(l))return ge;y=y&&Nn(l,d,a),d=l}else{for(c=0;c<e.length;l>=65536?c+=2:c++){if(l=Fe(e,c),l===$e)u=!0,h&&(f=f||c-p-1>r&&e[p+1]!==" ",p=c);else if(!Be(l))return ge;y=y&&Nn(l,d,a),d=l}f=f||h&&c-p-1>r&&e[p+1]!==" "}return!u&&!f?y&&!o&&!i(e)?$r:s===Pe?ge:Ft:n>9&&Mr(e)?ge:o?s===Pe?ge:Ft:f?Br:Pr}function dc(e,t,n,r,i){e.dump=function(){if(t.length===0)return e.quotingType===Pe?'""':"''";if(!e.noCompatMode&&(tc.indexOf(t)!==-1||nc.test(t)))return e.quotingType===Pe?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),a=r||e.flowLevel>-1&&n>=e.flowLevel;function c(l){return ac(e,l)}switch(uc(t,a,e.indent,o,c,e.quotingType,e.forceQuotes&&!r,i)){case $r:return t;case Ft:return"'"+t.replace(/'/g,"''")+"'";case Pr:return"|"+jn(t,e.indent)+Ln(Rn(t,s));case Br:return">"+jn(t,e.indent)+Ln(Rn(fc(t,o),s));case ge:return'"'+hc(t)+'"';default:throw new P("impossible error: invalid scalar style")}}()}function jn(e,t){var n=Mr(e)?String(t):"",r=e[e.length-1]===`
`,i=r&&(e[e.length-2]===`
`||e===`
`),s=i?"+":r?"":"-";return n+s+`
`}function Ln(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function fc(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var l=e.indexOf(`
`);return l=l!==-1?l:e.length,n.lastIndex=l,Mn(e.slice(0,l),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=n.exec(e);){var a=o[1],c=o[2];s=c[0]===" ",r+=a+(!i&&!s&&c!==""?`
`:"")+Mn(c,t),i=s}return r}function Mn(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,i=0,s,o=0,a=0,c="";r=n.exec(e);)a=r.index,a-i>t&&(s=o>i?o:a,c+=`
`+e.slice(i,s),i=s+1),o=a;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function hc(e){for(var t="",n=0,r,i=0;i<e.length;n>=65536?i+=2:i++)n=Fe(e,i),r=L[n],!r&&Be(n)?(t+=e[i],n>=65536&&(t+=e[i+1])):t+=r||ic(n);return t}function pc(e,t,n){var r="",i=e.tag,s,o,a;for(s=0,o=n.length;s<o;s+=1)a=n[s],e.replacer&&(a=e.replacer.call(n,String(s),a)),(q(e,t,a,!1,!1)||typeof a>"u"&&q(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=i,e.dump="["+r+"]"}function $n(e,t,n,r){var i="",s=e.tag,o,a,c;for(o=0,a=n.length;o<a;o+=1)c=n[o],e.replacer&&(c=e.replacer.call(n,String(o),c)),(q(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&q(e,t+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=Rt(e,t)),e.dump&&$e===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function mc(e,t,n){var r="",i=e.tag,s=Object.keys(n),o,a,c,l,d;for(o=0,a=s.length;o<a;o+=1)d="",r!==""&&(d+=", "),e.condenseFlow&&(d+='"'),c=s[o],l=n[c],e.replacer&&(l=e.replacer.call(n,c,l)),q(e,t,c,!1,!1)&&(e.dump.length>1024&&(d+="? "),d+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),q(e,t,l,!1,!1)&&(d+=e.dump,r+=d));e.tag=i,e.dump="{"+r+"}"}function gc(e,t,n,r){var i="",s=e.tag,o=Object.keys(n),a,c,l,d,u,f;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new P("sortKeys must be a boolean or a function");for(a=0,c=o.length;a<c;a+=1)f="",(!r||i!=="")&&(f+=Rt(e,t)),l=o[a],d=n[l],e.replacer&&(d=e.replacer.call(n,l,d)),q(e,t+1,l,!0,!0,!0)&&(u=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,u&&(e.dump&&$e===e.dump.charCodeAt(0)?f+="?":f+="? "),f+=e.dump,u&&(f+=Rt(e,t)),q(e,t+1,d,!0,u)&&(e.dump&&$e===e.dump.charCodeAt(0)?f+=":":f+=": ",f+=e.dump,i+=f));e.tag=s,e.dump=i||"{}"}function Pn(e,t,n){var r,i,s,o,a,c;for(i=n?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(a=i[s],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof t=="object"&&t instanceof a.instanceOf)&&(!a.predicate||a.predicate(t))){if(n?a.multi&&a.representName?e.tag=a.representName(t):e.tag=a.tag:e.tag="?",a.represent){if(c=e.styleMap[a.tag]||a.defaultStyle,Or.call(a.represent)==="[object Function]")r=a.represent(t,c);else if(Dr.call(a.represent,c))r=a.represent[c](t,c);else throw new P("!<"+a.tag+'> tag resolver accepts not "'+c+'" style');e.dump=r}return!0}return!1}function q(e,t,n,r,i,s,o){e.tag=null,e.dump=n,Pn(e,n,!1)||Pn(e,n,!0);var a=Or.call(e.dump),c=r,l;r&&(r=e.flowLevel<0||e.flowLevel>t);var d=a==="[object Object]"||a==="[object Array]",u,f;if(d&&(u=e.duplicates.indexOf(n),f=u!==-1),(e.tag!==null&&e.tag!=="?"||f||e.indent!==2&&t>0)&&(i=!1),f&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(d&&f&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),a==="[object Object]")r&&Object.keys(e.dump).length!==0?(gc(e,t,e.dump,i),f&&(e.dump="&ref_"+u+e.dump)):(mc(e,t,e.dump),f&&(e.dump="&ref_"+u+" "+e.dump));else if(a==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?$n(e,t-1,e.dump,i):$n(e,t,e.dump,i),f&&(e.dump="&ref_"+u+e.dump)):(pc(e,t,e.dump),f&&(e.dump="&ref_"+u+" "+e.dump));else if(a==="[object String]")e.tag!=="?"&&dc(e,e.dump,t,s,c);else{if(a==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new P("unacceptable kind of an object to dump "+a)}e.tag!==null&&e.tag!=="?"&&(l=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?l="!"+l:l.slice(0,18)==="tag:yaml.org,2002:"?l="!!"+l.slice(18):l="!<"+l+">",e.dump=l+" "+e.dump)}return!0}function yc(e,t){var n=[],r=[],i,s;for(Nt(e,n,r),i=0,s=r.length;i<s;i+=1)t.duplicates.push(n[r[i]]);t.usedDuplicates=new Array(s)}function Nt(e,t,n){var r,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)n.indexOf(i)===-1&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Nt(e[i],t,n);else for(r=Object.keys(e),i=0,s=r.length;i<s;i+=1)Nt(e[r[i]],t,n)}function vc(e,t){t=t||{};var n=new oc(t);n.noRefs||yc(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),q(n,0,r,!0,!0)?n.dump+`
`:""}var _c=vc,xc={dump:_c},yt=$a.load,vt=xc.dump;const wc=V({devices:V({spines:Ve(V({id:M(),model:M(),ports:ae()})),leaves:Ve(V({id:M(),model:M(),ports:ae()})),servers:Ve(V({id:M(),type:M(),connections:ae()}))}),connections:Ve(V({from:V({device:M(),port:M()}),to:V({device:M(),port:M()}),type:Ys(["uplink","downlink","endpoint"])})),metadata:V({generatedAt:zs(),fabricName:M(),totalDevices:ae()})});function bc(e){const t=[...e.devices.spines.map(s=>({...s,type:"spine"})),...e.devices.leaves.map(s=>({...s,type:"leaf"}))].sort((s,o)=>s.id.localeCompare(o.id)),n={switches:t,metadata:{totalSwitches:t.length,generatedAt:e.metadata.generatedAt.toISOString()}},r={servers:e.devices.servers.sort((s,o)=>s.id.localeCompare(o.id)),metadata:{totalServers:e.devices.servers.length,generatedAt:e.metadata.generatedAt.toISOString()}},i={connections:e.connections.sort((s,o)=>s.from.device.localeCompare(o.from.device)||s.from.port.localeCompare(o.from.port)),metadata:{totalConnections:e.connections.length,fabricName:e.metadata.fabricName,generatedAt:e.metadata.generatedAt.toISOString()}};return{servers:vt(r,{sortKeys:!0,indent:2,lineWidth:120,quotingType:'"'}),switches:vt(n,{sortKeys:!0,indent:2,lineWidth:120,quotingType:'"'}),connections:vt(i,{sortKeys:!0,indent:2,lineWidth:120,quotingType:'"'})}}function kc(e){try{const t=yt(e.servers),n=yt(e.switches),r=yt(e.connections);if(!t||!Array.isArray(t.servers))throw new Error("Invalid servers data: missing or invalid servers array");if(!n||!Array.isArray(n.switches))throw new Error("Invalid switches data: missing or invalid switches array");if(!r||!Array.isArray(r.connections))throw new Error("Invalid connections data: missing or invalid connections array");const i=t.servers,s=n.switches,o=r.connections,a=s.filter(f=>f.type==="spine").map(({type:f,...h})=>h),c=s.filter(f=>f.type==="leaf").map(({type:f,...h})=>h),l=[t.metadata?.generatedAt,n.metadata?.generatedAt,r.metadata?.generatedAt].filter(Boolean),d=l.length>0?new Date(Math.max(...l.map(f=>new Date(f).getTime()))):new Date,u={devices:{spines:a,leaves:c,servers:i},connections:o,metadata:{generatedAt:d,fabricName:r.metadata?.fabricName||"unnamed-fabric",totalDevices:a.length+c.length+i.length}};return wc.parse(u),u}catch(t){throw new Error(`Failed to deserialize wiring diagram: ${t instanceof Error?t.message:"Unknown error"}`)}}var Bn={};class Sc{storage=new Map;join(...t){return t.join("/").replace(/\/+/g,"/").replace(/\/+$/,"").replace(/^\.\//,"")||"/"}async mkdir(t,n){return Promise.resolve()}async writeFile(t,n,r){if(this.storage.set(t,n),typeof window<"u"&&window.localStorage)try{window.localStorage.setItem(`fgd:${t}`,n)}catch{}}async readFile(t,n){const r=this.storage.get(t);if(r!==void 0)return r;if(typeof window<"u"&&window.localStorage)try{const s=window.localStorage.getItem(`fgd:${t}`);if(s!==null)return this.storage.set(t,s),s}catch{}const i=new Error(`ENOENT: no such file or directory, open '${t}'`);throw i.code="ENOENT",i}async access(t){if(!(this.storage.has(t)||typeof window<"u"&&window.localStorage?.getItem(`fgd:${t}`)!==null)){const r=new Error(`ENOENT: no such file or directory, access '${t}'`);throw r.code="ENOENT",r}}async readdir(t,n){const r=[];for(const i of this.storage.keys())if(i.startsWith(t+"/")){const o=i.slice(t.length+1).split("/");o.length>0&&o[0]&&!r.includes(o[0])&&r.push(o[0])}if(typeof window<"u"&&window.localStorage)try{for(let i=0;i<window.localStorage.length;i++){const s=window.localStorage.key(i);if(s?.startsWith(`fgd:${t}/`)){const c=s.slice(4).slice(t.length+1).split("/");c.length>0&&c[0]&&!r.includes(c[0])&&r.push(c[0])}}}catch{}return n?.withFileTypes?r.map(i=>({name:i,isDirectory:()=>!1})):r}async rm(t,n){if(Array.from(this.storage.keys()).filter(i=>i===t||i.startsWith(t+"/")).forEach(i=>this.storage.delete(i)),typeof window<"u"&&window.localStorage)try{const i=[];for(let s=0;s<window.localStorage.length;s++){const o=window.localStorage.key(s);(o?.startsWith(`fgd:${t}`)||o===`fgd:${t}`)&&i.push(o)}i.forEach(s=>window.localStorage.removeItem(s))}catch{}}}class Ac{async mkdir(t,n){await(await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url)).promises.mkdir(t,n)}async writeFile(t,n,r){await(await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url)).promises.writeFile(t,n,r)}async readFile(t,n){return(await(await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url)).promises.readFile(t,n)).toString()}async access(t){await(await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url)).promises.access(t)}async readdir(t,n){const r=await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url);return n?.withFileTypes?r.promises.readdir(t,{withFileTypes:!0}):r.promises.readdir(t)}async rm(t,n){await(await de(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url)).promises.rm(t,n)}join(...t){return require("path").join(...t)}}function Tc(){return typeof process<"u"&&Bn&&Bn.node?new Ac:new Sc}const O=Tc();async function Cc(e,t){const n=t.baseDir||"./fgd",r=O.join(n,t.fabricId),i=`fgd-${t.fabricId}-${Date.now()}`;try{t.createDirs!==!1&&await O.mkdir(r,{recursive:!0});const s=bc(e),o=O.join(r,"servers.yaml"),a=O.join(r,"switches.yaml"),c=O.join(r,"connections.yaml");return await Promise.all([O.writeFile(o,s.servers,"utf8"),O.writeFile(a,s.switches,"utf8"),O.writeFile(c,s.connections,"utf8")]),{success:!0,fgdId:i,fabricPath:r,filesWritten:[o,a,c]}}catch(s){return{success:!1,fgdId:i,fabricPath:r,filesWritten:[],error:s instanceof Error?s.message:"Unknown error during save"}}}async function Zr(e){const t=e.baseDir||"./fgd",n=O.join(t,e.fabricId),r=O.join(n,"servers.yaml"),i=O.join(n,"switches.yaml"),s=O.join(n,"connections.yaml");try{await Promise.all([O.access(r),O.access(i),O.access(s)]);const[o,a,c]=await Promise.all([O.readFile(r,"utf8"),O.readFile(i,"utf8"),O.readFile(s,"utf8")]);return{success:!0,diagram:kc({servers:o,switches:a,connections:c}),fabricPath:n,filesRead:[r,i,s]}}catch(o){let a="Unknown error during load";return o.code==="ENOENT"?a=`FGD files not found at ${n}. Expected files: servers.yaml, switches.yaml, connections.yaml`:o instanceof Error&&(a=o.message),{success:!1,fabricPath:n,filesRead:[],error:a}}}async function Ec(e,t="./fgd"){const n=O.join(t,e),r=["servers.yaml","switches.yaml","connections.yaml"];try{return await Promise.all(r.map(i=>O.access(O.join(n,i)))),!0}catch{return!1}}const Ic=({context:e})=>{const t=e.config;return console.log("GUARD isValidConfig: called with config:",JSON.stringify(t,null,2)),!t.uplinksPerLeaf||!t.endpointCount?(console.log("GUARD isValidConfig: Missing uplinksPerLeaf or endpointCount"),!1):t.uplinksPerLeaf%2!==0?(console.log("GUARD isValidConfig: Odd uplinks per leaf"),!1):!t.endpointProfile||!t.endpointProfile.name?(console.log("GUARD isValidConfig: Missing endpoint profile"),!1):!t.spineModelId||!t.leafModelId?(console.log("GUARD isValidConfig: Missing model IDs"),!1):(console.log("GUARD isValidConfig: Configuration is valid - RETURNING TRUE"),!0)},Oc=({context:e})=>{const t=e.computedTopology;return!!(t?.isValid&&t.leavesNeeded>0&&t.spinesNeeded>0&&t.oversubscriptionRatio<=4)},Dc=lr({id:"fabricDesign",initial:"configuring",context:{config:{name:"",spineModelId:"DS3000",leafModelId:"DS2000",uplinksPerLeaf:2,endpointProfile:{name:"Standard Server",portsPerEndpoint:2},endpointCount:48},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null},states:{configuring:{on:{UPDATE_CONFIG:{actions:C({config:({context:e,event:t})=>({...e.config,...t.data}),errors:[]})},COMPUTE_TOPOLOGY:[{guard:Ic,target:"computed",actions:C({computedTopology:({context:e})=>{try{console.log("COMPUTE_TOPOLOGY: Guard passed, computing topology"),console.log("COMPUTE_TOPOLOGY: Config:",JSON.stringify(e.config,null,2));const t=Hs(e.config);return console.log("COMPUTE_TOPOLOGY: Result:",JSON.stringify(t,null,2)),console.log("COMPUTE_TOPOLOGY: Transitioning to computed state"),t}catch(t){return console.error("COMPUTE_TOPOLOGY: computeDerived failed:",t),null}},errors:[]})},{target:"invalid",actions:C({errors:({context:e})=>(console.log("COMPUTE_TOPOLOGY: Guard failed, going to invalid state"),e.config&&e.config.uplinksPerLeaf%2!==0?["Uplinks per leaf must be even for proper distribution"]:["Invalid configuration"])})}],RESET:{target:"configuring",actions:C({config:{},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})},LOAD_FROM_FGD:{target:"loading"}}},computed:{on:{UPDATE_CONFIG:{target:"configuring",actions:C({config:({context:e,event:t})=>({...e.config,...t.data}),computedTopology:null,errors:[]})},SAVE_TO_FGD:[{guard:Oc,target:"saving",actions:C({errors:[]})},{target:"invalid",actions:C({errors:({context:e})=>{const t=e.computedTopology;if(!t)return["No topology computed"];if(!t.isValid)return t.validationErrors;const n=[];return t.oversubscriptionRatio>4&&n.push(`Oversubscription too high: ${t.oversubscriptionRatio.toFixed(2)}:1`),t.leavesNeeded===0&&n.push("No leaves computed"),t.spinesNeeded===0&&n.push("No spines computed"),n.length>0?n:["Cannot save invalid topology"]}})}],RESET:{target:"configuring",actions:C({config:{},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})}}},invalid:{on:{UPDATE_CONFIG:{target:"configuring",actions:C({config:({context:e,event:t})=>({...e.config,...t.data}),computedTopology:null,errors:[]})},RESET:{target:"configuring",actions:C({config:{},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})}}},loading:{invoke:{id:"loadFgd",src:on(async({input:e})=>{const t=await Zr({fabricId:e.fabricId});if(!t.success)throw new Error(t.error||"Failed to load from FGD");return{success:!0,diagram:t.diagram}}),input:({event:e})=>({fabricId:e.fabricId}),onDone:{target:"loaded",actions:C({loadedDiagram:({event:e})=>e.output.diagram,errors:[]})},onError:{target:"configuring",actions:C({errors:({event:e})=>[`Failed to load from FGD: ${e.error?.message||"Unknown error"}`]})}}},saving:{invoke:{id:"saveFgd",src:on(async({input:e})=>{if(!e.context.computedTopology?.isValid)throw new Error("Invalid topology cannot be saved");const t=e.context.config,n=Ws(t,e.context.computedTopology),r=await Cc(n,{fabricId:t.name||`fabric-${Date.now()}`});if(!r.success)throw new Error(r.error||"Failed to save to FGD");return{success:!0,fgdId:r.fgdId,wiringDiagram:n}}),input:({context:e})=>({context:e}),onDone:{target:"saved",actions:C({savedToFgd:!0,errors:[]})},onError:{target:"computed",actions:C({errors:({event:e})=>[`Failed to save to FGD: ${e.error?.message||"Unknown error"}`]})}}},saved:{on:{UPDATE_CONFIG:{target:"configuring",actions:C({config:({context:e,event:t})=>({...e.config,...t.data}),computedTopology:null,errors:[],savedToFgd:!1})},RESET:{target:"configuring",actions:C({config:{},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})}}},loaded:{on:{UPDATE_CONFIG:{target:"configuring",actions:C({config:({context:e,event:t})=>({...e.config,...t.data}),computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})},LOAD_FROM_FGD:{target:"loading"},RESET:{target:"configuring",actions:C({config:{},computedTopology:null,errors:[],savedToFgd:!1,loadedDiagram:null})}}}}});async function Rc(e,t,n={}){try{if(!await Ec(e,n.baseDir))return{hasDrift:!1,driftSummary:["No files found on disk - nothing to compare against"],lastChecked:new Date,affectedFiles:[]};const i=await Zr({fabricId:e,baseDir:n.baseDir});if(!i.success||!i.diagram)throw new Error(i.error||"Failed to load diagram from disk");const s=Fc(t,i.diagram,n);return{hasDrift:s.hasDrift,driftSummary:jc(s.changes),lastChecked:new Date,affectedFiles:i.filesRead}}catch(r){return{hasDrift:!1,driftSummary:[`Error detecting drift: ${r instanceof Error?r.message:"Unknown error"}`],lastChecked:new Date,affectedFiles:[]}}}function Fc(e,t,n={}){const r=Date.now(),i=[],s=Zn([...e.devices.spines,...e.devices.leaves],[...t.devices.spines,...t.devices.leaves],"switch");i.push(...s);const o=Zn(e.devices.servers,t.devices.servers,"endpoint");i.push(...o);const a=Nc(e.connections,t.connections);i.push(...a);const c={fabricId:e.metadata.fabricName||"unknown",hasDrift:i.length>0,categories:{switches:_t(i.filter(d=>d.category==="switch")),endpoints:_t(i.filter(d=>d.category==="endpoint")),connections:_t(i.filter(d=>d.category==="connection"))},affectedFiles:[],lastChecked:new Date},l=Date.now();return{hasDrift:i.length>0,changes:i,summary:c,performanceMetrics:{comparisonTimeMs:l-r,memoryDiagramSize:Vn(e),diskFilesTotalSize:Vn(t)}}}function Zn(e,t,n){const r=[],i=new Set(e.map(c=>c.id)),s=new Set(t.map(c=>c.id)),o=new Map(e.map(c=>[c.id,c])),a=new Map(t.map(c=>[c.id,c]));for(const c of i)if(!s.has(c)){const l=o.get(c);r.push({type:"added",category:n,itemId:c,description:`${n} '${c}' added (model: ${l.model||l.type||"unknown"})`,details:l})}for(const c of s)if(!i.has(c)){const l=a.get(c);r.push({type:"removed",category:n,itemId:c,description:`${n} '${c}' removed (was: ${l.model||l.type||"unknown"})`,details:l})}for(const c of i)if(s.has(c)){const l=o.get(c),d=a.get(c);if(!ct(l,d)){const u=Ur(l,d);r.push({type:"modified",category:n,itemId:c,description:`${n} '${c}' modified (${u.join(", ")})`,details:{current:l,disk:d}})}}return r}function Nc(e,t){const n=[],r=c=>`${c.from.device}:${c.from.port}->${c.to.device}:${c.to.port}`,i=new Set(e.map(r)),s=new Set(t.map(r)),o=new Map(e.map(c=>[r(c),c])),a=new Map(t.map(c=>[r(c),c]));for(const c of i)if(!s.has(c)){const l=o.get(c);n.push({type:"added",category:"connection",itemId:c,description:`Connection added: ${l.from.device}:${l.from.port} -> ${l.to.device}:${l.to.port}`,details:l})}for(const c of s)if(!i.has(c)){const l=a.get(c);n.push({type:"removed",category:"connection",itemId:c,description:`Connection removed: ${l.from.device}:${l.from.port} -> ${l.to.device}:${l.to.port}`,details:l})}for(const c of i)if(s.has(c)){const l=o.get(c),d=a.get(c);if(!ct(l,d)){const u=Ur(l,d);n.push({type:"modified",category:"connection",itemId:c,description:`Connection modified: ${c} (${u.join(", ")})`,details:{current:l,disk:d}})}}return n}function _t(e){return{added:e.filter(t=>t.type==="added").length,removed:e.filter(t=>t.type==="removed").length,modified:e.filter(t=>t.type==="modified").length,details:e.map(t=>t.description)}}function jc(e){if(e.length===0)return["No drift detected - in-memory topology matches files on disk"];const t=[],n=Un(e,r=>r.category);for(const[r,i]of n){const s=Un(i,a=>a.type),o=[];s.get("added")?.length&&o.push(`${s.get("added").length} added`),s.get("removed")?.length&&o.push(`${s.get("removed").length} removed`),s.get("modified")?.length&&o.push(`${s.get("modified").length} modified`),o.length>0&&t.push(`${r}s: ${o.join(", ")}`)}return t}function ct(e,t){if(e===t)return!0;if(e==null||t==null||typeof e!="object"||typeof t!="object")return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n)if(!r.includes(i)||!ct(e[i],t[i]))return!1;return!0}function Ur(e,t){const n=[],r=new Set([...Object.keys(e),...Object.keys(t)]);for(const i of r)i in e?i in t?ct(e[i],t[i])||n.push(`${i} changed`):n.push(`added ${i}`):n.push(`removed ${i}`);return n}function Un(e,t){const n=new Map;for(const r of e){const i=t(r);n.has(i)||n.set(i,[]),n.get(i).push(r)}return n}function Vn(e){return JSON.stringify(e).length}function Lc({fabricId:e,onBackToList:t}){const[n,r]=pr(Dc),[i,s]=W.useState(null),[o,a]=W.useState(!1);return S.jsxs("div",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[S.jsx("h1",{children:"HNC Fabric Designer v0.2"}),S.jsx("button",{onClick:t,style:{padding:"0.5rem 1rem",backgroundColor:"#757575",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← Back to List"})]}),S.jsx(zr,{fabricId:e,driftStatus:i,onRefreshDrift:c,isRefreshing:o}),S.jsx("div",{style:{marginBottom:"1rem"},children:S.jsxs("label",{children:["Fabric Name:",S.jsx("input",{type:"text",value:n.context.config.name||"",onChange:l=>r({type:"UPDATE_CONFIG",data:{name:l.target.value}}),style:{marginLeft:"0.5rem",padding:"0.25rem"}})]})}),S.jsx("div",{style:{marginBottom:"1rem"},children:S.jsxs("label",{children:["Spine Model:",S.jsx("select",{value:n.context.config.spineModelId||"DS3000",onChange:l=>r({type:"UPDATE_CONFIG",data:{spineModelId:l.target.value}}),style:{marginLeft:"0.5rem",padding:"0.25rem"},children:S.jsx("option",{value:"DS3000",children:"DS3000"})})]})}),S.jsx("div",{style:{marginBottom:"1rem"},children:S.jsxs("label",{children:["Leaf Model:",S.jsx("select",{value:n.context.config.leafModelId||"DS2000",onChange:l=>r({type:"UPDATE_CONFIG",data:{leafModelId:l.target.value}}),style:{marginLeft:"0.5rem",padding:"0.25rem"},children:S.jsx("option",{value:"DS2000",children:"DS2000"})})]})}),S.jsx("div",{style:{marginBottom:"1rem"},children:S.jsxs("label",{children:["Uplinks Per Leaf:",S.jsx("input",{type:"number",min:"1",max:"4",value:n.context.config.uplinksPerLeaf||2,onChange:l=>r({type:"UPDATE_CONFIG",data:{uplinksPerLeaf:parseInt(l.target.value)}}),style:{marginLeft:"0.5rem",padding:"0.25rem",width:"60px"}})]})}),S.jsx("div",{style:{marginBottom:"1rem"},children:S.jsxs("label",{children:["Endpoint Count:",S.jsx("input",{type:"number",min:"1",value:n.context.config.endpointCount||48,onChange:l=>r({type:"UPDATE_CONFIG",data:{endpointCount:parseInt(l.target.value)}}),style:{marginLeft:"0.5rem",padding:"0.25rem",width:"80px"}})]})}),S.jsxs("div",{style:{marginBottom:"1rem"},children:[S.jsx("button",{onClick:()=>r({type:"COMPUTE_TOPOLOGY"}),disabled:n.matches("computing")||n.matches("saving"),style:{padding:"0.5rem 1rem",marginRight:"0.5rem"},children:n.matches("computing")?"Computing...":"Compute Topology"}),n.matches("computed")&&S.jsx("button",{onClick:()=>r({type:"SAVE_TO_FGD"}),disabled:n.matches("saving"),style:{padding:"0.5rem 1rem"},children:n.matches("saving")?"Saving...":"Save to FGD"})]}),n.context.errors.length>0&&S.jsxs("div",{style:{color:"red",marginBottom:"1rem"},children:[S.jsx("h3",{children:"Errors:"}),S.jsx("ul",{children:n.context.errors.map((l,d)=>S.jsx("li",{children:l},d))})]}),n.context.computedTopology&&S.jsxs("div",{style:{border:"1px solid #ccc",padding:"1rem",marginBottom:"1rem"},children:[S.jsx("h3",{children:"Computed Topology"}),S.jsxs("p",{children:["Leaves needed: ",n.context.computedTopology.leavesNeeded]}),S.jsxs("p",{children:["Spines needed: ",n.context.computedTopology.spinesNeeded]}),S.jsxs("p",{children:["Oversubscription ratio: ",n.context.computedTopology.oversubscriptionRatio,":1"]}),S.jsxs("p",{children:["Valid: ",n.context.computedTopology.isValid?"Yes":"No"]})]}),n.matches("saved")&&S.jsx("div",{style:{color:"green",padding:"1rem",border:"1px solid green"},children:"✅ Topology saved to FGD successfully!"}),S.jsxs("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"2rem"},children:["Fabric ID: ",e," | State: ",String(n.value)," | Config: ",JSON.stringify(n.context.config)]})]});async function c(){if(!n.context.loadedDiagram){s({hasDrift:!1,driftSummary:["No topology loaded - cannot check drift"],lastChecked:new Date,affectedFiles:[]});return}a(!0);try{const l=await Rc(e,n.context.loadedDiagram);s(l)}catch(l){s({hasDrift:!1,driftSummary:[`Error checking drift: ${l instanceof Error?l.message:"Unknown error"}`],lastChecked:new Date,affectedFiles:[]})}finally{a(!1)}}}function Uc(){const[e,t]=pr(vs),n=c=>{t({type:"CREATE_FABRIC",name:c})},r=c=>{t({type:"SELECT_FABRIC",fabricId:c})},i=c=>{t({type:"DELETE_FABRIC",fabricId:c})},s=()=>{t({type:"BACK_TO_LIST"})},o=async c=>{console.log(`Checking drift for fabric: ${c}`)},a=()=>{console.log("Opening drift details view")};return e.matches("selected")&&e.context.selectedFabricId?S.jsx(Lc,{fabricId:e.context.selectedFabricId,onBackToList:s}):S.jsx(Gr,{fabrics:e.context.fabrics,onCreateFabric:n,onSelectFabric:r,onDeleteFabric:i,onCheckDrift:o,onViewDriftDetails:a,errors:e.context.errors,isCreating:e.matches("creating")})}export{Uc as A};
